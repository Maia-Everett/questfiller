{"version":3,"sources":["webpack:///webpack/bootstrap c15f5df9104b72eb5c15","webpack:///./common/shortcuts.js","webpack:///./parsers/utils.js","webpack:///./model/mission/Mission.js","webpack:///./parsers/substitutions.js","webpack:///./model/core/ItemReward.js","webpack:///./main.js","webpack:///./Parsers.js","webpack:///./parsers/ParserContext.js","webpack:///./parsers/QuestParser.js","webpack:///./templates/quest.ejs","webpack:///./model/quest/Quest.js","webpack:///./model/quest/ReputationGain.js","webpack:///./parsers/MissionParser.js","webpack:///./templates/mission.ejs","webpack:///./model/mission/GarrisonMission.js","webpack:///./model/mission/NavalMission.js","webpack:///./model/mission/ClassHallMission.js","webpack:///./model/mission/MissionEnemy.js","webpack:///./parsers/NPCParser.js","webpack:///./templates/npc.ejs","webpack:///./model/npc/NPC.js","webpack:///./model/npc/NPCQuest.js","webpack:///./model/npc/SoldItem.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;AC7DA;AAAA;AACA;AACA;AACA,oBAAoB,OAAO;AAC3B,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oBAAoB,OAAO;AAC3B,YAAY,SAAS;AACrB;AACA;AACA;AACA;;;;;;;;AClBA;AACA,qCAAqC;AACrC;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;;AAEA,wCAAwC;AACxC;AACA;AACA;AACA;;AAEA;AACA,8CAA8C,iDAAiD,EAAE;AACjG;AACA,EAAE;;AAEF;AACA,YAAY,QAAQ;AACpB,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA,4BAA4B,EAAE;AAC9B;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,kDAAkD;AAClD,EAAE;;AAEF;AACA,YAAY,QAAQ;AACpB,aAAa;AACb;AACA;AACA;AACA,EAAE;;AAEF;AACA,YAAY,OAAO;AACnB,YAAY,cAAc;AAC1B,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA,YAAY,QAAQ;AACpB,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA,YAAY,QAAQ;AACpB,YAAY,OAAO;AACnB,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA,YAAY,QAAQ;AACpB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,2BAA2B;AACvC,aAAa;AACb;AACA;AACA;AACA,EAAE;;AAEF;AACA,YAAY,SAAS;AACrB,YAAY,OAAO;AACnB,YAAY,2BAA2B;AACvC,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA,YAAY,QAAQ;AACpB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA,YAAY,QAAQ;AACpB,YAAY,iDAAiD;AAC7D;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;;AAExB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH,EAAE;;AAEF;AACA,YAAY,QAAQ;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA,YAAY,QAAQ;AACpB,YAAY,8BAA8B;AAC1C;AACA;AACA,gDAAgD,YAAY;AAC5D;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA,YAAY,OAAO;AACnB,aAAa;AACb;AACA;AACA,iCAAiC,GAAG;AACpC;AACA;;;;;;;;ACtTA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;ACzCA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;;;;;;;;AC3BA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AAAA;AAAA;;;;;;;;;;;ACvBgB;AAChB;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;;;;;;;;;;;;;;AClCe;AAChB;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,C;;;;;;;AC5CA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;;;;;;;;;;;;;;;;;ACxEgB;AAChB;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,YAAY,MAAM;AAClB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,MAAM;AAClB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,MAAM;AAClB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,IAAI;AACJ;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA,YAAY,MAAM;AAClB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA,YAAY,MAAM;AAClB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,mBAAmB;AAC/B;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA,YAAY,QAAQ;AACpB,YAAY,eAAe;AAC3B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,QAAQ;AACpB,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,YAAY,MAAM;AAClB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA,8BAA8B,iBAAiB;AAC/C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,MAAM;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,MAAM;AAClB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,MAAM;AAClB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACjZA;AACA;AACA,gDAAgD,sBAAsB,sBAAsB,uBAAuB,wBAAwB;AAC3I;AACA;AACA;AACA,mCAAmC,QAAQ,gBAAgB,MAAM,OAAO,QAAQ,YAAY,MAAM,QAAQ,6BAA6B,oBAAoB,kGAAkG,uCAAuC,sBAAsB,iCAAiC,gCAAgC,4CAA4C,wDAAwD,8CAA8C,sBAAsB,iCAAiC,2BAA2B,2CAA2C,6BAA6B,6CAA6C,OAAO,gCAAgC,kEAAkE,4CAA4C,4BAA4B,8BAA8B,wCAAwC,4EAA4E,kEAAkE,oBAAoB,IAAI,UAAU,4BAA4B,qDAAqD,sCAAsC,wEAAwE,yBAAyB,WAAW,6BAA6B,gCAAgC,sEAAsE,cAAc,UAAU,6EAA6E,2BAA2B,oCAAoC,oBAAoB,EAAE,6BAA6B,gCAAgC,4DAA4D,cAAc,UAAU,WAAW,sBAAsB,mBAAmB,mEAAmE,MAAM,4BAA4B,+BAA+B,4BAA4B,6BAA6B,wEAAwE,2EAA2E,gBAAgB,IAAI,gEAAgE,uEAAuE,gBAAgB,IAAI,oDAAoD,+BAA+B,QAAQ,0CAA0C,+BAA+B,OAAO,eAAe,2CAA2C,0BAA0B,kDAAkD,wCAAwC,4BAA4B,mDAAmD,gDAAgD,gCAAgC,OAAO,eAAe,gCAAgC,mDAAmD,QAAQ,8GAA8G,+BAA+B,8CAA8C,0BAA0B,SAAS,QAAQ,2DAA2D,2CAA2C,aAAa,kCAAkC,wDAAwD,sEAAsE,wBAAwB,0DAA0D,aAAa,eAAe,6DAA6D,QAAQ,yCAAyC,QAAQ,0BAA0B,wDAAwD,aAAa,gBAAgB,6DAA6D,+BAA+B,8CAA8C,0BAA0B,SAAS,QAAQ,UAAU,yBAAyB,2CAA2C,4BAA4B,6CAA6C,8BAA8B,uCAAuC,8CAA8C,mDAAmD,qCAAqC,WAAW,8CAA8C,uBAAuB,qDAAqD,+BAA+B,qCAAqC,MAAM,8BAA8B,UAAU,IAAI,wBAAwB;AAC9jJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA,gCAAgC,gBAAgB;AAChD;AACA,iBAAiB;AACjB,gCAAgC,YAAY;AAC5C;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,qIAAqI;AAChL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,qIAAqI;AAClL;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,uDAAuD,6DAA6D;AACpH;AACA;AACA,kDAAkD,UAAU,IAAI,gDAAgD;AAChH,aAAa;AACb;AACA;AACA,KAAK;AACL;AACA;AACA,C;;;;;;;;ACjYA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;ACnEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;ACrCgB;AAChB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,cAAc;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;;AAGA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,IAAI;;AAEJ;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,gBAAgB;AAC5B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;AACJ;AACA;AACA;;;;;;;ACtRA;AACA;AACA,gDAAgD,sBAAsB,sBAAsB,uBAAuB,wBAAwB;AAC3I;AACA;AACA;AACA,kBAAkB,iIAAiI,yCAAyC,gCAAgC,8CAA8C,8DAA8D,kDAAkD,sBAAsB,yBAAyB,4BAA4B,+BAA+B,4DAA4D,6CAA6C,6FAA6F,0DAA0D,aAAa,EAAE,sBAAsB,mCAAmC,4BAA4B,uDAAuD,uBAAuB,uBAAuB,mEAAmE,MAAM,yBAAyB,iDAAiD,gCAAgC,uDAAuD,mCAAmC,oEAAoE,0BAA0B,6BAA6B,gEAAgE,aAAa,EAAE,UAAU,QAAQ,4CAA4C,gCAAgC,OAAO,eAAe,sCAAsC,gBAAgB,gCAAgC,MAAM,4CAA4C,uEAAuE,MAAM,iCAAiC,IAAI,UAAU,6BAA6B,kEAAkE,gCAAgC,gDAAgD,QAAQ,0EAA0E,6BAA6B,gDAAgD,0BAA0B,SAAS,MAAM,uCAAuC,4CAA4C,aAAa,iCAAiC,wDAAwD,uBAAuB,UAAU,mEAAmE,MAAM,gCAAgC,wEAAwE,UAAU,UAAU,4BAA4B,6BAA6B,uCAAuC,QAAQ,4BAA4B,UAAU,IAAI,4BAA4B;AAChsF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,qIAAqI;AACpL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,sDAAsD;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,uDAAuD;AAC5F;AACA,qBAAqB;AACrB;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,qIAAqI;AAC/K;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD,6DAA6D;AAClH;AACA;AACA,gDAAgD,UAAU,IAAI,kDAAkD;AAChH,aAAa;AACb;AACA;AACA,KAAK;AACL;AACA;AACA,C;;;;;;;;AC7NA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;;ACVA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;;ACVA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;ACVA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,eAAe;AAC3B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;ACdgB;AAChB;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,WAAW,cAAc;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,YAAY,IAAI;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,IAAI;AAChB,YAAY,QAAQ;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,YAAY,IAAI;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA,YAAY,IAAI;AAChB,YAAY,OAAO;AACnB;AACA;AACA;;AAEA,mGAA6C,yCAAyC;AACtF;AACA,GAAG;;AAEH;;AAEA,mGAA6C,uCAAuC;AACpF;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,YAAY,IAAI;AAChB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,YAAY,IAAI;AAChB,YAAY,OAAO;AACnB;AACA;AACA,iGAA2C,sCAAsC;AACjF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA,YAAY,IAAI;AAChB,YAAY,OAAO;AACnB;AACA;AACA,mGAA6C,yCAAyC;AACtF;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;;AAEA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,YAAY,IAAI;AAChB,YAAY,QAAQ;AACpB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,IAAI;AAChB;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;;AAEA;AACA,YAAY,IAAI;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;AACL,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACnVA;AACA;AACA,gDAAgD,sBAAsB,sBAAsB,uBAAuB,wBAAwB;AAC3I;AACA;AACA;AACA,kBAAkB,UAAU,sBAAsB,QAAQ,+BAA+B,MAAM,QAAQ,gFAAgF,qCAAqC,oFAAoF,4BAA4B,oCAAoC,kDAAkD,wBAAwB,0CAA0C,sBAAsB,sCAAsC,uDAAuD,wDAAwD,sFAAsF,+CAA+C,wCAAwC,4BAA4B,0BAA0B,uCAAuC,uBAAuB,mBAAmB,mEAAmE,MAAM,QAAQ,6DAA6D,QAAQ,6GAA6G,6CAA6C,QAAQ,uDAAuD,8CAA8C,4EAA4E,MAAM,SAAS,MAAM,OAAO,OAAO,6FAA6F,sCAAsC,4EAA4E,MAAM,SAAS,MAAM,UAAU,+BAA+B,yDAAyD,4DAA4D,yBAAyB,SAAS,kBAAkB,OAAO,OAAO,SAAS,YAAY,OAAO,IAAI,2BAA2B,QAAQ,aAAa,MAAM,SAAS,WAAW,+BAA+B,yDAAyD,0BAA0B,WAAW,4BAA4B,+BAA+B,uCAAuC,MAAM,8BAA8B,UAAU,IAAI,wBAAwB,wBAAwB,+CAA+C,gCAAgC,qCAAqC,gCAAgC,qCAAqC,kCAAkC,gCAAgC,sEAAsE,+CAA+C;AAC9qF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,4BAA4B,UAAU;AACtC;AACA;AACA,gCAAgC,oDAAoD;AACpF;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iGAAiG,oGAAoG;AACrM;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,qIAAqI;AAChL;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA,wHAAwH,8IAA8I;AACtQ;AACA,yBAAyB;AACzB,oCAAoC;AACpC;AACA,qBAAqB;AACrB,mCAAmC;AACnC;AACA;AACA,4FAA4F,8IAA8I;AAC1O;AACA,yBAAyB;AACzB,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,kBAAkB;AAC9D;AACA,6BAA6B;AAC7B,4CAA4C,YAAY;AACxD;AACA;AACA,yBAAyB;AACzB,wCAAwC,aAAa;AACrD;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD,6DAA6D;AACpH;AACA;AACA,kDAAkD,UAAU,IAAI,8CAA8C;AAC9G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;AACL;AACA;AACA,C;;;;;;;ACrMA;;AAEA;AACA;AACA,WAAW,YAAY;AACvB,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;AC3EA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;ACpBA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AAAA;AAAA","file":"page.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c15f5df9104b72eb5c15","/**\n * Alias for `document.querySelector`.\n * \n * @param selector {string} selector to query\n * @return {Element} element\n */\nexport function $(selector) {\n\treturn document.querySelector(selector);\n}\n\n/**\n * Alias for `document.querySelectorAll`.\n * \n * @param selector {string} selector to query\n * @return {NodeList} search result\n */\nexport function $$(selector) {\n\treturn document.querySelectorAll(selector);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./common/shortcuts.js\n// module id = 0\n// module chunks = 0","function escapeRegExp(string) {\n\treturn string.replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\])/g, \"\\\\$1\");\n}\n  \nexport default {\n\t/**\n\t * @return {Array.<number>}\n\t */\n\tgetCategoryIds: function() {\n\t\tlet breadcrumbData;\n\n\t\tfor (let script of document.getElementsByTagName(\"script\")) {\n\t\t\tlet text = script.textContent;\n\n\t\t\tif (text.includes(\"PageTemplate.set({breadcrumb:\")) {\n\t\t\t\tbreadcrumbData = text;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\t// ugh, parsing JS with regexes\n\t\tlet regex = escapeRegExp(\"PageTemplate.set({breadcrumb: [\") + \"([0-9,-]+)\" + escapeRegExp(\"]});\");\n\t\treturn this.getRegexGroup(breadcrumbData, regex, 1).split(\",\").map(id => parseInt(id, 10));\n\t},\n\t\n\t/**\n\t * @param {boolean} stripColor\n\t * @return {Array.<string>}\n\t */\n\tgetInfoboxLines: function(stripColor) {\n\t\tlet infoboxData = null;\n\t\t\n\t\tthis.getElementContainingOwnText(document, \"script\", \"arkup.printHtml\", script => {\n\t\t\tinfoboxData = script.textContent;\n\t\t});\n\t\t\n\t\tif (!infoboxData) {\n\t\t\treturn [];\n\t\t}\n\t\t\n\t\tlet infoboxMarkup = this.getRegexGroup(infoboxData, \"[Mm]arkup\\\\.printHtml\\\\((['\\\"])(.*)\\\\1, 'infobox\", 2)\n\t\t\t\t\t.replace(/\\\\\\//g, \"/\") // unescape forward slashes (the regex matches the string \\/)\n\t\t\t\t\t.replace(/\\\\x([0-9A-Z]{2})/g, escapeSeq => String.fromCharCode(parseInt(hex, 16)));\n\t\t\t\t\t// Convert \\xNN escape sequences to their corresponding characters\n\t\t\n\t\t// We'll get BBCode, convert it to a list of plain text lines\n\t\tlet lines = [];\n\n\t\tfor (let line of infoboxMarkup.split(\"[/li][li]\")) {\n\t\t\tlines.push.apply(lines, line.split(\"[br]\"));\n\t\t}\n\n\t\treturn lines.map(line => line.replace(/\\[(?:race|class|money)=([0-9]+)\\]/g, \"$1\"))\n\t\t\t\t.map(stripColor ? line => line\n\t\t\t\t\t\t: line => line.replace(/\\[color=([^\\]]+)\\]/g, \"<$1>\"))\n\t\t\t\t.map(line => line.replace(/\\[[^\\]]+\\]/g, \"\"));          // remove all square bracket tags\n\t},\n\n\t/**\n\t * @param {Element} element\n\t * @return {string}\n\t */\n\ttagName: function(element) {\n\t\treturn element.tagName.toLowerCase();\n\t},\n\n\t/**\n\t * @param {string} str\n\t * @param {string|RegExp} regex\n\t * @param {number} group\n\t * @param {function} onFound\n\t * @return {string}\n\t */\n\tgetRegexGroup: function(str, regex, group, onFound) {\n\t\tif (!regex instanceof RegExp) {\n\t\t\tregex = new Regex(regex);\n\t\t}\n\t\t\n\t\tlet match = str.match(regex);\n\n\t\tif (match === null) {\n\t\t\treturn null;\n\t\t}\n\n\t\tlet result = match[group];\n\n\t\tif (onFound) {\n\t\t\tonFound(result);\n\t\t}\n\t\t\n\t\treturn result;\n\t},\n\n\t/**\n\t * @param {Element} el\n\t * @return {string}\n\t */\n\ttextOf: function(el) {\n\t\tlet result = \"\";\n\n\t\tfor (let node of el.childNodes) {\n\t\t\tif (node instanceof Text) {\n\t\t\t\tresult += node.textContent;\n\t\t\t} else if (node instanceof Element) {\n\t\t\t\tif (this.tagName(node) === \"br\") {\n\t\t\t\t\tresult += \"\\n\";\n\t\t\t\t} else {\n\t\t\t\t\tresult += this.textOf(node);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.normalize(result);\n\t},\n\t\n\t/**\n\t * @param {Element} header\n\t * @param {string} nextTagName\n\t * @return {string}\n\t */\n\tcollectTextUntilNextTag: function(header, nextTagName) {\n\t\tlet result = \"\";\n\t\t\n\t\tfor (let node = header.nextSibling;\n\t\t\t\t!(node instanceof Element && this.tagName(node) === nextTagName);\n\t\t\t\tnode = node.nextSibling) {\n\t\t\tif (node instanceof Text) {\n\t\t\t\tresult += node.textContent;\n\t\t\t} else if (node instanceof Element && this.tagName(node) === \"br\") {\n\t\t\t\tresult += \"\\n\";\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn result;\n\t},\n\n\t/**\n\t * @param {Element} element\n\t * @param {string} tagName\n\t * @param {string} text\n\t * @param {(element: Element) => void} onFound\n\t * @return {Element}\n\t */\n\tgetElementContainingOwnText: function(element, tagName, text, onFound) {\n\t\treturn this.getFirstWithOwnText(element.getElementsByTagName(tagName), text, onFound);\n\t},\n\n\t/**\n\t * @param {NodeList} elements\n\t * @param {string} text\n\t * @param {(element: Element) => void} onFound\n\t * @return {Element}\n\t */\n\tgetFirstWithOwnText: function(elements, text, onFound) {\n\t\tfor (let child of elements) {\n\t\t\tif (child.textContent.includes(text)) {\n\t\t\t\tif (onFound) {\n\t\t\t\t\tonFound(child);\n\t\t\t\t}\n\n\t\t\t\treturn child;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t},\n\n\t/**\n\t * @param {Element} element\n\t * @param {string} tagName\n\t * @param {string} text\n\t * @return {Array.<Element>}\n\t */\n\tgetElementsContainingOwnText: function(element, tagName, text) {\n\t\tlet result = [];\n\n\t\tfor (let child of document.getElementsByTagName(tagName)) {\n\t\t\tif (child.textContent.includes(text)) {\n\t\t\t\tresult.push(child);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t},\n\t\n\t/**\n\t * @param {Element} icontab\n\t * @param {(itemName: string, itemQuantity: number) => void} collector\n\t */\n\tcollectItemRewards: function(icontab, collector) {\n\t\tlet itemNamesByIconId = new Map();\n\t\tlet itemQuantitiesByIconId = new Map();\n\t\t\n\t\t// Item names are contained in the actual icontab, as are placeholders for the icon and quantity\n\t\tfor (let iconPlaceholder of icontab.querySelectorAll(\"th[id]\")) {\n\t\t\tlet iconId = iconPlaceholder.id;\n\t\t\t// the next element is a td with the link to the actual item\n\t\t\tlet itemName = iconPlaceholder.nextElementSibling.getElementsByTagName(\"a\")[0].textContent;\n\t\t\titemNamesByIconId.set(iconId, itemName);\n\t\t}\n\t\t\n\t\t// Item quantities are filled through JavaScript.\n\t\t// Find all script elements in the document containing icontab initialization code\n\t\tfor (let script of this.getElementsContainingOwnText(document, \"script\", \"icontab\")) {\n\t\t\t// Parse JavaScript lines like\n\t\t\t// $WH.ge('icontab-icon1').appendChild(g_items.createIcon(115793, 1, \"3\"));\n\t\t\t// We're interested in what's inside ge() - the icon box ID -\n\t\t\t// and the contents of the last quotes (item quantity)\n\t\t\tlet iconInitRegex = new RegExp(\n\t\t\t\t\tescapeRegExp(\"WH.ge('\")\n\t\t\t\t\t+ \"([^']+)\"\n\t\t\t\t\t+ escapeRegExp(\"').appendChild(\") + \"[A-Za-z0-9_]+\" + escapeRegExp(\".createIcon(\")\n\t\t\t\t\t+ \"[^\\\"]+\\\"([^\\\"]+)\\\"\"\n\t\t\t\t\t+ escapeRegExp(\"));\"), \"g\");\n\t\t\t\n\t\t\tlet scriptText = script.textContent;\n\t\t\tlet match;\n\t\t\t\n\t\t\twhile ((match = iconInitRegex.exec(scriptText)) !== null) {\n\t\t\t\t// group 1 is icon box element ID, group 2 is item quantity (or 0 if no quantity should be displayed)\n\t\t\t\titemQuantitiesByIconId.set(match[1], parseInt(match[2]));\n\t\t\t}\n\t\t}\n\t\t\n\t\titemNamesByIconId.forEach((itemName, iconId) => {\n\t\t\tlet itemQuantity = itemQuantitiesByIconId.get(iconId);\n\t\t\t\n\t\t\t// \"0\" means draw no quantity on the icon\n\t\t\tif (itemQuantity === undefined || itemQuantity == 0 || itemQuantity == 1) {\n\t\t\t\titemQuantity = null;\n\t\t\t}\n\t\t\t\n\t\t\tcollector(itemName, itemQuantity);\n\t\t});\n\t},\n\t\n\t/**\n\t * @param {Element} container\n\t * @return {number}\n\t */\n\tgetMoney: function(container) {\n\t\tlet allMoneyElements = [];\n\t\tallMoneyElements.push.apply(allMoneyElements, container.querySelectorAll(\"span.moneygold\"));\n\t\tallMoneyElements.push.apply(allMoneyElements, container.querySelectorAll(\"span.moneysilver\"));\n\t\tallMoneyElements.push.apply(allMoneyElements, container.querySelectorAll(\"span.moneycopper\"));\n\t\t\n\t\tif (allMoneyElements.length === 0) {\n\t\t\treturn 0;\n\t\t}\n\t\t\n\t\t// Find the leftmost money element (so we parse only the first group - second group is max level rewards)\n\t\tlet money = 0;\n\t\tlet leftEl = null;\n\t\t\n\t\tfor (let el of allMoneyElements) {\n\t\t\tif (leftEl === null || el.siblingIndex < leftEl.siblingIndex) {\n\t\t\t\tleftEl = el;\n\t\t\t}\n\t\t}\n\t\t\n\t\tlet node;\n\t\t\n\t\t// Parse all directly adjacent span nodes, possibly with whitespace in between\n\t\tfor (node = leftEl;\n\t\t\t\t(node instanceof Element && this.tagName(node) === \"span\")\n\t\t\t\t\t|| (node instanceof Text && node.textContent.trim().length === 0);\n\t\t\t\tnode = node.nextSibling) {\n\t\t\tif (!(node instanceof Element)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tif (node.classList.contains(\"moneygold\")) {\n\t\t\t\tmoney += parseInt(node.textContent) * 10000;\n\t\t\t} else if (node.classList.contains(\"moneysilver\")) {\n\t\t\t\tmoney += parseInt(node.textContent) * 100;\n\t\t\t} else if (node.classList.contains(\"moneycopper\")) {\n\t\t\t\tmoney += parseInt(node.textContent);\n\t\t\t}\n\t\t}\n\t\t\n\t\t// If the money group we just parsed is followed immediately by max level text, then it means that the only\n\t\t// money group is the max-level money group, so we should skip it.\n\t\tif (node instanceof Text && node.textContent.trim().startsWith(\"if completed at level\")) {\n\t\t\treturn 0;\n\t\t}\n\t\t\n\t\treturn money;\n\t},\n\t\n\t/**\n\t * @param {Element} startElement\n\t * @param {(element: Element) => boolean} condition\n\t */\n\tfindNextElementSibling: function(startElement, condition) {\n\t\tfor (let el = startElement.nextElementSibling; el != null; el = el.nextElementSibling) {\n\t\t\tif (condition(el)) {\n\t\t\t\treturn el;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn null;\n\t},\n\n\t/**\n\t * @param {string} str\n\t * @return {string}\n\t */\n\tnormalize: function(str) {\n\t\treturn str.trim().replace(/[ ]{2,}/g, \" \");\n\t}\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./parsers/utils.js\n// module id = 1\n// module chunks = 0","export default class Mission {\n\tconstructor() {\n\t\t this.enemies = [];\n\t\t this.bonusItems = [];\n\t}\n\n\thasRewards() {\n\t\treturn this.bonusItems.length > 0 || this.hasNonItemRewards();\n\t}\n\t\n\thasNonItemRewards() {\n\t\treturn !!this.bonusXP || !!this.bonusMoney || !!this.bonusResources;\n\t}\n\n\tgetFollowerXPStr() {\n\t\tif (!this.followerXP) {\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\treturn new Intl.NumberFormat(\"en-US\").format(this.followerXP);\n\t}\n\n\tgetBonusXPStr() {\n\t\tif (!bonusXP) {\n\t\t\treturn null;\n\t\t}\n\t\t\n\t\treturn new Intl.NumberFormat(\"en-US\").format(this.bonusXP);\n\t}\n\t\n\tgetGold() {\n\t\treturn Math.floor(this.money / 10000) || \"\";\n\t}\n\n\tgetSilver() {\n\t\treturn (Math.floor(this.money / 100) % 100) || \"\";\n\t}\n\n\tgetCopper() {\n\t\treturn (this.money % 100) || \"\";\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./model/mission/Mission.js\n// module id = 2\n// module chunks = 0","let patches = {\n\t\"4.0.3\": \"4.0.3a\",\n\t\"6.0.1\": \"6.0.2\",\n\t\"7.0.1\": \"7.0.3\",\n};\n\nlet reputations = {\n\t\"Stormwind\": \"Stormwind (faction)\",\n\t\"Ironforge\": \"Ironforge (faction)\",\n\t\"Darnassus\": \"Darnassus (faction)\",\n\t\"Exodar\": \"Exodar (faction)\",\n\t\"Gnomeregan\": \"Gnomeregan (faction)\",\n\t\"Gilneas\": \"Gilneas (faction)\",\n\t\"Orgrimmar\": \"Orgrimmar (faction)\",\n\t\"Thunder Bluff\": \"Thunder Bluff (faction)\",\n\t\"Undercity\": \"Undercity (faction)\",\n\t\"Silvermoon\": \"Silvermoon (faction)\",\n};\n\nexport default {\n\tgetCanonicalPatchVersion : function(patch) {\n\t\treturn patches[patch] || patch;\n\t},\n\n\tgetCanonicalReputationFaction : function(repFaction) {\n\t\treturn reputations[repFaction] || repFaction;\n\t}\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./parsers/substitutions.js\n// module id = 3\n// module chunks = 0","export default class ItemReward {\n\t/**\n\t * \n\t * @param {string} name \n\t * @param {number} quantity \n\t * @param {number} index \n\t */\n\tconstructor(name, quantity, index) {\n\t\tthis.name = name;\n\t\tthis.quantity = quantity;\n\t\tthis.index = index;\n\t}\n\n\t/**\n\t * @return {string}\n\t */\n\ttoString() {\n\t\tif (this.quantity == null) {\n\t\t\treturn this.name;\n\t\t}\n\t\t\n\t\treturn this.name + \" (\" + this.quantity + \")\";\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./model/core/ItemReward.js\n// module id = 4\n// module chunks = 0","import { $, $$ } from \"./common/shortcuts\";\nimport Parsers from \"./Parsers\";\n\n// Remove any existing popups, if any\n$$(\"#questfiller-popup\").forEach(element => element.parentElement.removeChild(element));\n\n// Create popup\nlet popup = document.createElement(\"div\");\npopup.setAttribute(\"id\", \"questfiller-popup\");\ndocument.body.appendChild(popup);\n\npopup.innerHTML = `\n\t<textarea id=\"questfiller-content\" spellcheck=\"false\"></textarea>\n\t<button id=\"questfiller-copy\">Copy to clipboard and close</button>\n`;\n\nvar content = $(\"#questfiller-content\");\n\n$(\"#questfiller-copy\").addEventListener(\"click\", e => {\n\tcontent.select();\n\tdocument.execCommand(\"copy\");\n\tpopup.parentElement.removeChild(popup);\n});\n\nParsers.create().then(parsers => {\n\tlet value = parsers.format();\n\n\tif (value) {\n\t\tcontent.value = value;\n\t\t$(\"#questfiller-copy\").focus();\n\t}\n}).catch(e => {\n\tcontent.value = e.message;\n\tconsole.log(e);\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./main.js\n// module id = 5\n// module chunks = 0","import { $, $$ } from \"./common/shortcuts\";\nimport u from \"./parsers/utils\";\n\nimport ParserContext from \"./parsers/ParserContext\";\nimport QuestParser from \"./parsers/QuestParser\";\nimport MissionParser from \"./parsers/MissionParser\";\nimport NPCParser from \"./parsers/NPCParser\";\n\nclass Parsers {\n\tconstructor(context) {\n\t\tthis.quest = new QuestParser(context);\n\t\tthis.mission = new MissionParser(context);\n\t\tthis.npc = new NPCParser(context);\n\t}\n\n\tformat() {\n\t\tlet url = $(\"link[rel=canonical]\").getAttribute(\"href\");\n\t\t\n\t\tif (!url) {\n\t\t\treturn null;\n\t\t}\n\n\t\tlet articleType = u.getRegexGroup(url, /\\/([a-z-]+)=[0-9]+\\//, 1);\n\t\tlet parser = this[articleType];\n\n\t\tif (!parser) {\n\t\t\treturn null;\n\t\t}\n\n\t\tlet parseResult = parser.parse();\n\n\t\t// Format\n\t\tlet context = {};\n\t\tcontext[parser.templatePrefix] = parseResult;\n\t\treturn parser.template(context);\n\t}\n};\n\nexport default {\n\tcreate: function() {\n\t\treturn ParserContext.create().then(context => {\n\t\t\treturn new Parsers(context);\n\t\t});\n\t}\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./Parsers.js\n// module id = 6\n// module chunks = 0","function arrayToDict(array, dict) {\n\tdict = dict || {};\n\tarray.forEach(element => dict[element[0]] = element[1]);\n\treturn dict;\n}\n\nclass ParserContext {\n\tconstructor(localeData) {\n\t\tthis.questCategories = {};\n\n\t\tlocaleData.mn_quests.forEach(element => {\n\t\t\tlet sublist = element[3];\n\t\t\t\n\t\t\tif (Array.isArray(sublist)) {\n\t\t\t\tsublist.forEach(subelement => {\n\t\t\t\t\t// category ID and name\n\t\t\t\t\tthis.questCategories[subelement[0]] = subelement[1];\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.missionMechanics = arrayToDict(localeData.fidropdowns.missionMechanics);\n\t\tarrayToDict(localeData.fidropdowns.missionThreats, this.missionMechanics);\n\t\tthis.races = arrayToDict(localeData.fidropdowns.race);\n\t\tthis.classes = arrayToDict(localeData.fidropdowns.classs);\n\t\tthis.npcTypes = localeData.g_npc_types;\n\n\t\t// This has to be hardcoded for now :(\n\t\tthis.legionMissionMechanics = {\n\t\t\t\"474\": \"Broken Gear\",\n\t\t\t\"471\": \"Cursed\",\n\t\t\t\"472\": \"Disorienting\",\n\t\t\t\"762\": \"Dungeon\",\n\t\t\t\"760\": \"Elite\",\n\t\t\t\"473\": \"Head Wound\",\n\t\t\t\"475\": \"Heroic\",\n\t\t\t\"437\": \"Lethal\",\n\t\t\t\"476\": \"Mythic\",\n\t\t\t\"761\": \"Placeholder\",\n\t\t\t\"436\": \"Powerful\",\n\t\t\t\"482\": \"Powerful\",\n\t\t\t\"763\": \"Raid\",\n\t\t\t\"428\": \"Slowing\",\n\t\t};\n\t}\n}\n\nexport default {\n\tcreate: function() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t// Hack: inject script to pass Wowhead localization data from window into content script\n\t\t\tfunction onMessage(e) {\n\t\t\t\tif (e.source === window && e.data.questFillerTag) {\n\t\t\t\t\twindow.removeEventListener(\"message\", onMessage);\n\t\t\t\t\tresolve(new ParserContext(e.data));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twindow.addEventListener(\"message\", onMessage);\n\n\t\t\tvar script = document.createElement(\"script\");\n\t\t\tscript.text = `\n\t\t\t\twindow.postMessage({\n\t\t\t\t\tquestFillerTag: \"questFillerTag\",\n\t\t\t\t\tg_npc_types: window.g_npc_types,\n\t\t\t\t\tmn_quests: window.mn_quests,\n\t\t\t\t\tfidropdowns: window.LANG.fidropdowns\n\t\t\t\t}, \"*\");\n\t\t\t`;\n\t\t\tdocument.head.appendChild(script);\n\t\t});\n\t}\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./parsers/ParserContext.js\n// module id = 7\n// module chunks = 0","import { $, $$ } from \"../common/shortcuts\";\nimport u from \"./utils\";\nimport substitutions from \"./substitutions\";\n\nimport questEJS from \"../templates/quest.ejs\";\n\nimport Quest from \"../model/quest/Quest\";\nimport ItemReward from \"../model/core/ItemReward\";\nimport ReputationGain from \"../model/quest/ReputationGain\";\n\nconst LEGION_SCALING_QUEST_CATEGORIES = new Set([\n\t\"Azsuna\", \"Val'sharah\", \"Highmountain\", \"Stormheim\", \"Artifact\"\n]);\n\n/**\n * @return {Quest}\n */\nexport default function QuestParser(context) {\n\tthis.name = \"Quest\";\n\tthis.templatePrefix = \"q\";\n\tthis.template = questEJS;\n\n\t/**\n\t * @return {Quest}\n\t */\n\tthis.parse = function() {\n\t\tlet quest = new Quest();\n\t\t\n\t\tlet url = $(\"link[rel=canonical]\").getAttribute(\"href\");\n\t\tlet idStr = u.getRegexGroup(url, \"/quest=([0-9]+)/\", 1);\n\t\tquest.id = parseInt(idStr, 10);\n\t\t\n\t\tlet mainContainer = $(\"#main-contents > div.text\");\n\t\tlet questName = $(\"h1.heading-size-1\");\n\t\tquest.name = questName.textContent;\n\t\t\n\t\tparseCategory(quest);\n\t\tparseObjectives(quest, mainContainer, questName);\n\t\tparseQuestText(quest, mainContainer);\n\t\tparseMoney(quest, mainContainer);\n\t\tparseRewards(quest, mainContainer);\n\t\tparseGains(quest, mainContainer);\n\t\tparseInfobox(quest);\n\t\tparseSeries(quest, mainContainer);\n\t\tparseRemoved(quest, mainContainer);\n\n\t\treturn quest;\n\t}\n\n\t/**\n\t * @param {Quest} quest\n\t */\n\tfunction parseCategory(quest) {\n\t\tlet categoryIds = u.getCategoryIds();\n\t\tlet categoryId = categoryIds[categoryIds.length - 1];\n\t\tquest.category = context.questCategories[categoryId.toString()];\n\t}\n\n\t/**\n\t * @param {Quest} quest \n\t * @param {Element} mainContainer\n\t * @param {Element} questName \n\t */\n\tfunction parseObjectives(quest, mainContainer, questName) {\n\t\t// Objectives section\n\t\tlet objectivesNode = questName.nextSibling;\n\t\t\n\t\t// Objectives text is the first non-empty text node immediately following the header\n\t\twhile (!(objectivesNode instanceof Text) || objectivesNode.data.trim().length === 0) {\n\t\t\tobjectivesNode = objectivesNode.nextSibling;\n\t\t}\n\t\t\n\t\tlet beforeObjectives = objectivesNode.previousSibling;\n\t\t\n\t\t// If there is a h2.heading-size-3 right before the \"objectives\" text, it is probably not objectives,\n\t\t// but rather progress or completion, like on the quest \"Draenei Tail\"\n\t\tif (!(beforeObjectives instanceof Element && u.tagName(beforeObjectives) === \"h2\"\n\t\t\t\t&& beforeObjectives.classList.contains(\"heading-size-3\"))) {\n\t\t\tquest.objectives = u.normalize(objectivesNode.data.trim);\n\t\t}\n\t\t\n\t\t// Objective completion stages\n\t\tlet iconlists = mainContainer.querySelectorAll(\"table.iconlist\");\n\t\t\n\t\tif (iconlists.length > 0) {\n\t\t\tlet stagesTable = iconlists[0];\n\n\t\t\t// Remove any subtables\n\t\t\tfor (let element of stagesTable.querySelectorAll(\"table.iconlist\")) {\n\t\t\t\telement.parentElement.removeChild(element);\n\t\t\t}\n\t\t\t\n\t\t\tfor (let stageLink of stagesTable.querySelectorAll(\"td a\")) {\n\t\t\t\t// Find the innermost td element enclosing the a, and add its whole text\n\t\t\t\tlet parent = stageLink.parentElement;\n\t\t\t\t\n\t\t\t\twhile (u.tagName(parent) !== \"td\") {\n\t\t\t\t\tparent = parent.parentElement;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tquest.stages.push(u.normalize(parent.textContent));\n\t\t\t}\n\n\t\t\t// Suggested players\n\t\t\tlet suggestedPlayers = u.getElementContainingOwnText(stagesTable, \"td\", \"Suggested players:\");\n\t\t\t\n\t\t\tif (suggestedPlayers != null) {\n\t\t\t\tlet playerCountStr =\n\t\t\t\t\t\tu.getRegexGroup(suggestedPlayers.textContent, \"Suggested players: ([0-9]+)\", 1);\n\t\t\t\tquest.groupSize = parseInt(playerCountStr);\n\t\t\t}\n\t\t}\n\t\t\n\t\t// Provided items\n\t\tif (iconlists.length >= 2) {\n\t\t\tlet maybeProvided = iconlists[1];\n\t\t\tlet before = maybeProvided.previousSibling;\n\t\t\t\n\t\t\tif (before instanceof Text && before.textContent.includes(\"Provided\")) {\n\t\t\t\tfor (let element of maybeProvided.querySelectorAll(\"table.iconlist\")) {\n\t\t\t\t\telement.parentElement.removeChild(element);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor (let itemLink of maybeProvided.querySelectorAll(\"td a\")) {\n\t\t\t\t\tquest.providedItems.push(u.normalize(itemLink.textContent));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @param {Quest} quest \n\t * @param {Element} mainContainer\n\t */\n\tfunction parseQuestText(quest, mainContainer) {\n\t\t// Description section\n\t\tlet headingsSize3 = mainContainer.querySelectorAll(\"h2.heading-size-3\");\n\t\t\n\t\tu.getFirstWithOwnText(headingsSize3, \"Description\", descriptionHeading => {\n\t\t\tquest.description = u.normalize(u.collectTextUntilNextTag(descriptionHeading, \"h2\"));\n\t\t});\n\t\t\n\t\t// Progress section\n\t\tlet progressHeading = document.getElementById(\"lknlksndgg-progress\");\n\t\t\n\t\tif (progressHeading != null) {\n\t\t\tquest.progress = u.textOf(progressHeading);\n\t\t} else {\n\t\t\tu.getFirstWithOwnText(headingsSize3, \"Progress\", fallbackProgressHeading => {\n\t\t\t\tquest.progress = u.normalize(u.collectTextUntilNextTag(fallbackProgressHeading, \"h2\"));\n\t\t\t});\n\t\t}\n\t\t\n\t\t// Completion section\n\t\tlet completionHeading = document.getElementById(\"lknlksndgg-completion\");\n\t\t\n\t\tif (completionHeading != null) {\n\t\t\tquest.completion = u.textOf(completionHeading);\n\t\t} else {\n\t\t\tu.getFirstWithOwnText(headingsSize3, \"Completion\", fallbackCompletionHeading => {\n\t\t\t\tquest.completion = u.normalize(u.collectTextUntilNextTag(fallbackCompletionHeading, \"h2\"));\n\t\t\t});\n\t\t}\n\t}\n\t\t\n\t/**\n\t * @param {Quest} quest \n\t * @param {Element} mainContainer\n\t */\n\tfunction parseMoney(quest, mainContainer) {\n\t\tquest.money = u.getMoney(mainContainer);\n\t}\n\t\n\t/**\n\t * @param {Quest} quest \n\t * @param {Element} mainContainer\n\t */\n\tfunction parseRewards(quest, mainContainer) {\n\t\t// Non-money rewards\n\t\tlet icontabs = mainContainer.querySelectorAll(\"table.icontab.icontab-box\");\n\t\t\n\t\tfor (let icontab of icontabs) {\n\t\t\tlet prevNode = icontab.previousSibling;\n\t\t\t\n\t\t\tif (icontab.id === \"dynamic-rewards\") {\n\t\t\t\tcollectItemRewards(icontab, quest.choiceRewards);\n\t\t\t} else if (prevNode instanceof Text) {\n\t\t\t\tlet prevText = prevNode.textContent;\n\t\t\t\t\n\t\t\t\tif (prevText.includes(\"You will receive:\") || prevText.includes(\"You will also receive:\")) {\n\t\t\t\t\tcollectItemRewards(icontab, quest.nonChoiceRewards);\n\t\t\t\t} else if (prevText.includes(\"You will be able to choose one of these rewards:\")) {\n\t\t\t\t\tcollectItemRewards(icontab, quest.choiceRewards);\n\t\t\t\t} else if (prevText.includes(\"You will learn:\")) {\n\t\t\t\t\tcollectNonItemRewards(icontab, quest.abilityRewards);\n\t\t\t\t} else if (prevText.includes(\"The following spell will be cast on you:\")) {\n\t\t\t\t\tcollectNonItemRewards(icontab, quest.buffRewards);\n\t\t\t\t} else if ((prevText.trim().length === 0 || prevText.includes(\"if completed at level\"))\n\t\t\t\t\t\t&& isMoneyRewardSpan(icontab.previousElementSibling)) {\n\t\t\t\t\t// This is probably an item tucked at the end after money rewards\n\t\t\t\t\tcollectItemRewards(icontab, quest.nonChoiceRewards);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t// Convenience collection adapter around ParseUtils.collectItemRewards, which expects a Consumer\n\t/**\n\t * @param {Element} icontab\n\t * @param {Array.<ItemReward>} collector\n\t */\n\tfunction collectItemRewards(icontab, collector) {\n\t\tu.collectItemRewards(icontab, (item, quantity) => {\n\t\t\tcollector.push(new ItemReward(item, quantity, collector.length + 1));\n\t\t});\n\t}\n\t\n\t/**\n\t * @param {Element} icontab\n\t * @param {Array.<string>} collector\n\t */\n\tfunction collectNonItemRewards(icontab, collector) {\n\t\tfor (let link of icontab.querySelectorAll(\"td > a\")) {\n\t\t\tcollector.push(u.normalize(link.textContent));\n\t\t}\n\t}\n\t\n\t/**\n\t * @param {Element} element\n\t * @return {boolean}\n\t */\n\tfunction isMoneyRewardSpan(element) {\n\t\treturn u.tagName(element) === \"span\" && /money(?:gold|silver|copper)/.test(element.className);\n\t}\n\n\t/**\n\t * @param {Quest} quest \n\t * @param {Element} mainContainer\n\t */\n\tfunction parseGains(quest, mainContainer) {\n\t\t// Gains section\n\t\tlet gainsData = null;\n\n\t\tfor (let heading of mainContainer.querySelectorAll(\"h2.heading-size-3\")) {\n\t\t\tif (heading.textContent === \"Gains\") {\n\t\t\t\tgainsData = u.findNextElementSibling(heading, el => u.tagName(el) === \"ul\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (gainsData) {\n\t\t\tlet divs = gainsData.getElementsByTagName(\"div\");\n\t\t\tlet firstNonXPDiv;\n\t\t\t\n\t\t\tif (divs[0].textContent.includes(\"experience\")) {\n\t\t\t\tfirstNonXPDiv = 1;\n\t\t\t\tlet xpValue = u.getRegexGroup(divs[0].textContent, \"([0-9,]*) experience\", 1);\n\t\t\t\tquest.experience = parseInt(xpValue.replace(\",\", \"\"));\n\t\t\t} else {\n\t\t\t\tfirstNonXPDiv = 0;\n\t\t\t}\n\t\t\t\n\t\t\tfor (let i = firstNonXPDiv; i < divs.length; i++) {\n\t\t\t\tlet div = divs[i];\n\t\t\t\t\n\t\t\t\tif (div.textContent.includes(\"reputation with\")) {\n\t\t\t\t\tlet repValue = div.getElementsByTagName(\"span\")[0].textContent;\n\t\t\t\t\tlet faction = div.getElementsByTagName(\"a\")[0].textContent;\n\t\t\t\t\tlet canonicalName = substitutions.getCanonicalReputationFaction(faction);\n\t\t\t\t\tquest.reputationGains.push(new ReputationGain(faction,\n\t\t\t\t\t\t\tcanonicalName === faction ? null : canonicalName,\n\t\t\t\t\t\t\tparseInt(repValue.replace(\",\", \"\"))));\n\t\t\t\t} else {\n\t\t\t\t\t// Non-reputation gain\n\t\t\t\t\tquest.otherGains.push(u.normalize(div.textContent));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t/**\n\t * @param {Quest} quest\n\t */\n\tfunction parseInfobox(quest) {\n\t\t// Infobox section\n\t\t// Pattern-match each infobox line\n\t\tfor (let infoboxLine of u.getInfoboxLines(true)) {\n\t\t\tu.getRegexGroup(infoboxLine, \"Level: ([0-9]+)\", 1, levelStr => {\n\t\t\t\tquest.level = parseInt(levelStr);\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Requires level ([0-9]+)\", 1, levelStr => {\n\t\t\t\tquest.levelRequired = parseInt(levelStr);\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Type: (.+)\", 1, type => {\n\t\t\t\tif (type === \"Artifact\") {\n\t\t\t\t\t// This is what wowpedia uses\n\t\t\t\t\tquest.type = \"Legendary\";\n\t\t\t\t} else {\n\t\t\t\t\tquest.type = type;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Side: (.+)\", 1, side => {\n\t\t\t\tif (side === \"Both\") {\n\t\t\t\t\tquest.faction = \"Neutral\";\n\t\t\t\t} else {\n\t\t\t\t\tquest.faction = side;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Race: ([0-9]+)\", 1, raceId => {\n\t\t\t\tquest.race = context.races[raceId];\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Class: ([0-9]+)\", 1, classId => {\n\t\t\t\tquest.characterClass = context.classes[classId];\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Start: (.+)\", 1, startEntity => {\n\t\t\t\tquest.startEntity = startEntity;\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"End: (.+)\", 1, finishEntity => {\n\t\t\t\tquest.finishEntity = finishEntity;\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Added in patch ([0-9]+.[0-9]+.[0-9]+)\", 1, patch => {\n\t\t\t\tquest.patchAdded = substitutions.getCanonicalPatchVersion(patch);\n\t\t\t});\n\t\t\t\n\t\t\tif (infoboxLine === \"Repeatable\") {\n\t\t\t\tquest.repeatable = true;\n\t\t\t} else if (infoboxLine === \"Sharable\") {\n\t\t\t\tquest.shareable = true;\n\t\t\t} else if (infoboxLine === \"Not sharable\") {\n\t\t\t\tquest.shareable = false;\n\t\t\t}\n\t\t\t\n\t\t\t// If we still don't know the level, and it's a Legion quest, its level probably scales\n\t\t\tif (!quest.level && LEGION_SCALING_QUEST_CATEGORIES.has(quest.category)) {\n\t\t\t\tquest.level = \"100 - 110\";\n\t\t\t}\n\t\t}\n\t}\n\t\n\t/**\n\t * @param {Quest} quest \n\t * @param {Element} mainContainer\n\t */\n\tfunction parseSeries(quest, mainContainer) {\n\t\t// Try to determine previous and next quests\n\t\tlet headingsSize3 = mainContainer.querySelectorAll(\"h2.heading-size-3\");\n\t\t/** @type {Element} */\n\t\tlet seriesTable = null;\n\n\t\tu.getFirstWithOwnText(headingsSize3, \"Series\", seriesHeader => {\n\t\t\tseriesTable = u.findNextElementSibling(seriesHeader,\n\t\t\t\t\tel => u.tagName(el) === \"table\" && el.classList.contains(\"series\"));\n\t\t});\n\n\t\tif (!seriesTable) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t// Find the table cell with the current quest, in bold\n\t\tlet ourQuestItem = seriesTable.getElementsByTagName(\"b\")[0];\n\t\tlet ourQuestCell = ourQuestItem.parentElement;\n\t\t\n\t\twhile (u.tagName(ourQuestCell) !== \"td\") {\n\t\t\tourQuestCell = ourQuestCell.parentElement;\n\t\t}\n\t\t\n\t\t// Find where in the table it is\n\t\tlet questCells = Array.from(seriesTable.getElementsByTagName(\"td\"));\n\t\tlet ourQuestIndex = questCells.indexOf(ourQuestCell);\n\t\t\n\t\tif (ourQuestIndex > 0) {\n\t\t\tlet previousQuests = u.textOf(questCells[ourQuestIndex - 1]).split(\"\\n\");\n\t\t\tpreviousQuests.forEach(q => quest.previousQuests.push(q));\n\t\t}\n\t\t\n\t\tif (ourQuestIndex < questCells.length - 1) {\n\t\t\tlet nextQuests = u.textOf(questCells[ourQuestIndex + 1]).split(\"\\n\");\n\t\t\tnextQuests.forEach(q => quest.nextQuests.push(q));\n\t\t}\n\t}\n\t\n\t/**\n\t * @param {Quest} quest \n\t * @param {Element} mainContainer\n\t */\n\tfunction parseRemoved(quest, mainContainer) {\n\t\t// Set a removed flag if there is an obsolete warning on the quest page\n\t\tfor (let el of mainContainer.querySelectorAll(\"b[style=\\\"color: red\\\"]\")) {\n\t\t\tif (el.textContent.startsWith(\"This quest was marked obsolete\")) {\n\t\t\t\tquest.removed = true;\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./parsers/QuestParser.js\n// module id = 8\n// module chunks = 0","module.exports = function anonymous(locals, filters, escape, rethrow) {\n    escape = escape || function(html) {\n        return String(html).replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/'/g, \"&#39;\").replace(/\"/g, \"&quot;\");\n    };\n    var __stack = {\n        lineno: 1,\n        input: '<% if (q.removed) { -%>\\n{{Removed|patch=}}\\n<% } else { -%>\\n{{Stub/Quest}}\\n<% } -%>\\n{{Questbox\\n<% if (q.removed) { -%>\\n | doc =\\n<% } -%>\\n | id = <%-q.id%>\\n | name = <%-q.name%>\\n | category = <%-q.category%>\\n<% if (q.faction) { -%>\\n | faction = <%-q.faction%>\\n<% } -%>\\n<% if (q.race) { -%>\\n | race = <%-q.race%>\\n<% } -%>\\n<% if (q.characterClass) { -%>\\n | class = <%-q.characterClass%>\\n<% } -%>\\n | level = <%-q.level%>\\n<% if (q.levelRequired) { -%>\\n | levelreq = <%-q.levelRequired%>\\n<% } -%>\\n<% if (q.type) { -%>\\n | type = <%-q.type%>\\n<% } -%>\\n<% if (q.groupSize) { -%>\\n | groupsize = <%-q.groupSize%>\\n<% } -%>\\n<% if (q.startEntity) { -%>\\n | start = [[<%-q.startEntity%>]]\\n<% } else { -%>\\n | start = Automatic\\n<% } -%>\\n<% if (q.finishEntity && q.startEntity !== q.finishEntity) { -%>\\n | end = [[<%-q.finishEntity%>]]\\n<% } else if (!q.finishEntity) { -%>\\n | end = Automatic\\n<% } -%>\\n<% if (q.reputationGains.length) { -%>\\n | reputation = <%\\n\tq.reputationGains.forEach(function(gain, index) {\\n\t\t%><%- gain %><%\\n\t\tif (index < q.reputationGains.length - 1) {\\n\t\t\t%><br /><%\\n\t\t}\\n\t}) %>\\n<% } -%>\\n<% if (q.experience) { -%>\\n | experience = <%-q.getExperienceStr()%>\\n<% } -%>\\n<% if (q.hasNonMoneyRewards()) { -%>\\n | rewards =\\n<% q.choiceRewards.forEach(function(reward, index) { -%>\\n<% if (index > 0) { -%>or <% } -%><% if (reward.quantity) { -%><%- reward.quantity %>x <% } -%>[[<%- reward.name %>]]<% if (index < q.choiceRewards.length - 1) { -%><br /><% } -%>\\n<% }) -%>\\n<% q.getAllNonChoiceRewards().forEach(function(reward, index, array) { -%>\\n<% if (index === 0) { -%><% if (q.choiceRewards.length) { -%><br /><br /><% } } -%><% if (reward.quantity) { -%><%- reward.quantity %>x <% } -%>[[<%- reward.name %>]]<% if (index < array.length - 1) { -%><br /><% } -%>\\n<% }) -%>\\n<% } %>\\n<% if (q.money) { -%>\\n | money = {{cost|<%- q.getGold() %>|<%- q.getSilver() %>|<%- q.getCopper() %>}}\\n<% } -%>\\n<% if (q.repeatable) { -%>\\n | repeatable = Yes\\n<% } -%>\\n<% if (!q.shareable) { -%>\\n | shareable = No\\n<% } -%>\\n | previous = <% q.previousQuests.forEach(function(quest, index) {\\n\t%>[[Quest:<%- quest %>]]<%\\n\t\tif (index < q.previousQuests.length - 1) {\\n\t\t\t%>, <%\\n\t\t}\\n\t}) %>\\n | next = <% q.nextQuests.forEach(function(quest, index) {\\n\t%>[[Quest:<%- quest %>]]<%\\n\t\tif (index < q.nextQuests.length - 1) {\\n\t\t\t%>, <%\\n\t\t}\\n\t}) %>\\n<% if (q.faction && q.faction !== \"Neutral\") { -%>\\n | other-faction =\\n <% } -%>\\n}}\\n\\n==Objectives==\\n<% if (q.objectives) { -%>\\n<%- q.objectives %>\\n<% } else { -%>\\n...\\n<% } -%>\\n<% q.stages.forEach(function(stage) { -%>\\n* <%- stage %>\\n<% }) -%>\\n<% q.providedItems.forEach(function(item) { -%>\\n* [[<%- item %>]] (provided)\\n<% }) -%>\\n<% if (q.groupSize) { -%>\\n* Suggested players: <%- q.groupSize %>\\n<% } -%>\\n\\n==Description==\\n<% if (q.description) { -%>\\n<%- q.description %>\\n<% } else { -%>\\n...\\n<% } -%>\\n\\n<% if (q.hasRewards()) { -%>\\n==Rewards==\\n<% if (q.choiceRewards.length) { -%>\\n{{itembox|You will be able to choose one of these rewards:\\n<% q.choiceRewards.forEach(function(reward, index) { -%>\\n<% if (reward.quantity) { %>|q<%- (index+1) %>=<%-reward.quantity%><% } %>|<%-reward.name%>\\n<% }) -%>\\n}}\\n\\n<% } -%>\\n<% q.abilityRewards.forEach(function(reward, index) { -%>\\nYou will <% if (q.hasItemRewards()) { -%>also <% } -%>learn: [[<%-reward%>]]\\n\\n<% }) %>\\n<% q.buffRewards.forEach(function(reward, index) { -%>\\nThe following spell will be cast on you: [[<%-reward%>]]\\n\\n<% }) -%>\\n<% if (q.money) { -%>\\nYou will <% if (q.hasChoiceAbilityOrBuffRewards()) { -%>also <% } -%>receive: {{cost|<%-q.getGold()%>|<%-q.getSilver()%>|<%-q.getCopper()%>}}\\n\\n<% } -%>\\n<% if (q.nonChoiceRewards.length) { -%>\\n{{itembox|<% if (!q.money) { -%>You will <% if (q.hasChoiceAbilityOrBuffRewards()) { -%>also <% } -%>receive:<% } -%>\\n<% q.nonChoiceRewards.forEach(function(reward, index) { -%>\\n<% if (reward.quantity) { %>|q<%- (index+1) %>=<%-reward.quantity%><% } %>|<%-reward.name%>\\n<% }) -%>\\n}}\\n\\n<% } -%>\\n<% } %>\\n<% if (q.progress) { -%>\\n==Progress==\\n<%-q.progress%>\\n\\n<% } -%>\\n<% if (q.completion) { -%>\\n==Completion==\\n<%-q.completion%>\\n<% } -%>\\n\\n<% if (q.hasGains()) { -%>\\n==Gains==\\n<% if (q.experience) { -%>\\n* <%-q.getExperienceStr()%> [[XP]]\\n<% } -%>\\n<% q.reputationGains.forEach(function(gain) { -%>\\n* <%-gain.getFullText()%>\\n<% }) -%>\\n<% } -%>\\n<% q.otherGains.forEach(function(gain) { -%>\\n* <%-gain%>\\n<% }) -%>\\n\\n==Progression==\\n...\\n<% if (q.patchAdded) { -%>\\n\\n==Patch changes==\\n* {{Patch <%-q.patchAdded%>|note=Added.}}\\n<% } -%>\\n\\n==External links==\\n{{subst:el}}\\n{{Elinks-quest|<%-q.id%>}}\\n',\n        filename: \".\"\n    };\n    function rethrow(err, str, filename, lineno) {\n        var lines = str.split(\"\\n\"), start = Math.max(lineno - 3, 0), end = Math.min(lines.length, lineno + 3);\n        var context = lines.slice(start, end).map(function(line, i) {\n            var curr = i + start + 1;\n            return (curr == lineno ? \" >> \" : \"    \") + curr + \"| \" + line;\n        }).join(\"\\n\");\n        err.path = filename;\n        err.message = (filename || \"ejs\") + \":\" + lineno + \"\\n\" + context + \"\\n\\n\" + err.message;\n        throw err;\n    }\n    try {\n        var buf = [];\n        with (locals || {}) {\n            (function() {\n                buf.push(\"\");\n                __stack.lineno = 1;\n                if (q.removed) {\n                    buf.push(\"{{Removed|patch=}}\\n\");\n                    __stack.lineno = 2;\n                } else {\n                    buf.push(\"{{Stub/Quest}}\\n\");\n                    __stack.lineno = 3;\n                }\n                buf.push(\"{{Questbox\\n\");\n                __stack.lineno = 4;\n                if (q.removed) {\n                    buf.push(\" | doc =\\n\");\n                    __stack.lineno = 5;\n                }\n                buf.push(\" | id = \", (__stack.lineno = 5, q.id), \"\\n | name = \", (__stack.lineno = 6, q.name), \"\\n | category = \", (__stack.lineno = 7, q.category), \"\\n\");\n                __stack.lineno = 8;\n                if (q.faction) {\n                    buf.push(\" | faction = \", (__stack.lineno = 8, q.faction), \"\\n\");\n                    __stack.lineno = 9;\n                }\n                buf.push(\"\");\n                __stack.lineno = 9;\n                if (q.race) {\n                    buf.push(\" | race = \", (__stack.lineno = 9, q.race), \"\\n\");\n                    __stack.lineno = 10;\n                }\n                buf.push(\"\");\n                __stack.lineno = 10;\n                if (q.characterClass) {\n                    buf.push(\" | class = \", (__stack.lineno = 10, q.characterClass), \"\\n\");\n                    __stack.lineno = 11;\n                }\n                buf.push(\" | level = \", (__stack.lineno = 11, q.level), \"\\n\");\n                __stack.lineno = 12;\n                if (q.levelRequired) {\n                    buf.push(\" | levelreq = \", (__stack.lineno = 12, q.levelRequired), \"\\n\");\n                    __stack.lineno = 13;\n                }\n                buf.push(\"\");\n                __stack.lineno = 13;\n                if (q.type) {\n                    buf.push(\" | type = \", (__stack.lineno = 13, q.type), \"\\n\");\n                    __stack.lineno = 14;\n                }\n                buf.push(\"\");\n                __stack.lineno = 14;\n                if (q.groupSize) {\n                    buf.push(\" | groupsize = \", (__stack.lineno = 14, q.groupSize), \"\\n\");\n                    __stack.lineno = 15;\n                }\n                buf.push(\"\");\n                __stack.lineno = 15;\n                if (q.startEntity) {\n                    buf.push(\" | start = [[\", (__stack.lineno = 15, q.startEntity), \"]]\\n\");\n                    __stack.lineno = 16;\n                } else {\n                    buf.push(\" | start = Automatic\\n\");\n                    __stack.lineno = 17;\n                }\n                buf.push(\"\");\n                __stack.lineno = 17;\n                if (q.finishEntity && q.startEntity !== q.finishEntity) {\n                    buf.push(\" | end = [[\", (__stack.lineno = 17, q.finishEntity), \"]]\\n\");\n                    __stack.lineno = 18;\n                } else if (!q.finishEntity) {\n                    buf.push(\" | end = Automatic\\n\");\n                    __stack.lineno = 19;\n                }\n                buf.push(\"\");\n                __stack.lineno = 19;\n                if (q.reputationGains.length) {\n                    buf.push(\" | reputation = \");\n                    __stack.lineno = 19;\n                    q.reputationGains.forEach(function(gain, index) {\n                        buf.push(\"\", (__stack.lineno = 21, gain), \"\");\n                        __stack.lineno = 21;\n                        if (index < q.reputationGains.length - 1) {\n                            buf.push(\"<br />\");\n                            __stack.lineno = 23;\n                        }\n                    });\n                    buf.push(\"\\n\");\n                    __stack.lineno = 26;\n                }\n                buf.push(\"\");\n                __stack.lineno = 26;\n                if (q.experience) {\n                    buf.push(\" | experience = \", (__stack.lineno = 26, q.getExperienceStr()), \"\\n\");\n                    __stack.lineno = 27;\n                }\n                buf.push(\"\");\n                __stack.lineno = 27;\n                if (q.hasNonMoneyRewards()) {\n                    buf.push(\" | rewards =\\n\");\n                    __stack.lineno = 28;\n                    q.choiceRewards.forEach(function(reward, index) {\n                        buf.push(\"\");\n                        __stack.lineno = 28;\n                        if (index > 0) {\n                            buf.push(\"or \");\n                            __stack.lineno = 28;\n                        }\n                        buf.push(\"\");\n                        __stack.lineno = 28;\n                        if (reward.quantity) {\n                            buf.push(\"\", (__stack.lineno = 28, reward.quantity), \"x \");\n                            __stack.lineno = 28;\n                        }\n                        buf.push(\"[[\", (__stack.lineno = 28, reward.name), \"]]\");\n                        __stack.lineno = 28;\n                        if (index < q.choiceRewards.length - 1) {\n                            buf.push(\"<br />\");\n                            __stack.lineno = 28;\n                        }\n                        buf.push(\"\");\n                        __stack.lineno = 28;\n                    });\n                    buf.push(\"\");\n                    __stack.lineno = 28;\n                    q.getAllNonChoiceRewards().forEach(function(reward, index, array) {\n                        buf.push(\"\");\n                        __stack.lineno = 28;\n                        if (index === 0) {\n                            buf.push(\"\");\n                            __stack.lineno = 28;\n                            if (q.choiceRewards.length) {\n                                buf.push(\"<br /><br />\");\n                                __stack.lineno = 28;\n                            }\n                        }\n                        buf.push(\"\");\n                        __stack.lineno = 28;\n                        if (reward.quantity) {\n                            buf.push(\"\", (__stack.lineno = 28, reward.quantity), \"x \");\n                            __stack.lineno = 28;\n                        }\n                        buf.push(\"[[\", (__stack.lineno = 28, reward.name), \"]]\");\n                        __stack.lineno = 28;\n                        if (index < array.length - 1) {\n                            buf.push(\"<br />\");\n                            __stack.lineno = 28;\n                        }\n                        buf.push(\"\");\n                        __stack.lineno = 28;\n                    });\n                    buf.push(\"\");\n                    __stack.lineno = 28;\n                }\n                buf.push(\"\\n\");\n                __stack.lineno = 29;\n                if (q.money) {\n                    buf.push(\" | money = {{cost|\", (__stack.lineno = 29, q.getGold()), \"|\", (__stack.lineno = 29, q.getSilver()), \"|\", (__stack.lineno = 29, q.getCopper()), \"}}\\n\");\n                    __stack.lineno = 30;\n                }\n                buf.push(\"\");\n                __stack.lineno = 30;\n                if (q.repeatable) {\n                    buf.push(\" | repeatable = Yes\\n\");\n                    __stack.lineno = 31;\n                }\n                buf.push(\"\");\n                __stack.lineno = 31;\n                if (!q.shareable) {\n                    buf.push(\" | shareable = No\\n\");\n                    __stack.lineno = 32;\n                }\n                buf.push(\" | previous = \");\n                __stack.lineno = 32;\n                q.previousQuests.forEach(function(quest, index) {\n                    buf.push(\"[[Quest:\", (__stack.lineno = 33, quest), \"]]\");\n                    __stack.lineno = 33;\n                    if (index < q.previousQuests.length - 1) {\n                        buf.push(\", \");\n                        __stack.lineno = 35;\n                    }\n                });\n                buf.push(\"\\n | next = \");\n                __stack.lineno = 38;\n                q.nextQuests.forEach(function(quest, index) {\n                    buf.push(\"[[Quest:\", (__stack.lineno = 39, quest), \"]]\");\n                    __stack.lineno = 39;\n                    if (index < q.nextQuests.length - 1) {\n                        buf.push(\", \");\n                        __stack.lineno = 41;\n                    }\n                });\n                buf.push(\"\\n\");\n                __stack.lineno = 44;\n                if (q.faction && q.faction !== \"Neutral\") {\n                    buf.push(\" | other-faction =\\n \");\n                    __stack.lineno = 45;\n                }\n                buf.push(\"}}\\n\\n==Objectives==\\n\");\n                __stack.lineno = 48;\n                if (q.objectives) {\n                    buf.push(\"\", (__stack.lineno = 48, q.objectives), \"\\n\");\n                    __stack.lineno = 49;\n                } else {\n                    buf.push(\"...\\n\");\n                    __stack.lineno = 50;\n                }\n                buf.push(\"\");\n                __stack.lineno = 50;\n                q.stages.forEach(function(stage) {\n                    buf.push(\"* \", (__stack.lineno = 50, stage), \"\\n\");\n                    __stack.lineno = 51;\n                });\n                buf.push(\"\");\n                __stack.lineno = 51;\n                q.providedItems.forEach(function(item) {\n                    buf.push(\"* [[\", (__stack.lineno = 51, item), \"]] (provided)\\n\");\n                    __stack.lineno = 52;\n                });\n                buf.push(\"\");\n                __stack.lineno = 52;\n                if (q.groupSize) {\n                    buf.push(\"* Suggested players: \", (__stack.lineno = 52, q.groupSize), \"\\n\");\n                    __stack.lineno = 53;\n                }\n                buf.push(\"\\n==Description==\\n\");\n                __stack.lineno = 55;\n                if (q.description) {\n                    buf.push(\"\", (__stack.lineno = 55, q.description), \"\\n\");\n                    __stack.lineno = 56;\n                } else {\n                    buf.push(\"...\\n\");\n                    __stack.lineno = 57;\n                }\n                buf.push(\"\\n\");\n                __stack.lineno = 58;\n                if (q.hasRewards()) {\n                    buf.push(\"==Rewards==\\n\");\n                    __stack.lineno = 59;\n                    if (q.choiceRewards.length) {\n                        buf.push(\"{{itembox|You will be able to choose one of these rewards:\\n\");\n                        __stack.lineno = 60;\n                        q.choiceRewards.forEach(function(reward, index) {\n                            buf.push(\"\");\n                            __stack.lineno = 60;\n                            if (reward.quantity) {\n                                buf.push(\"|q\", (__stack.lineno = 60, index + 1), \"=\", (__stack.lineno = 60, reward.quantity), \"\");\n                                __stack.lineno = 60;\n                            }\n                            buf.push(\"|\", (__stack.lineno = 60, reward.name), \"\\n\");\n                            __stack.lineno = 61;\n                        });\n                        buf.push(\"}}\\n\\n\");\n                        __stack.lineno = 63;\n                    }\n                    buf.push(\"\");\n                    __stack.lineno = 63;\n                    q.abilityRewards.forEach(function(reward, index) {\n                        buf.push(\"You will \");\n                        __stack.lineno = 63;\n                        if (q.hasItemRewards()) {\n                            buf.push(\"also \");\n                            __stack.lineno = 63;\n                        }\n                        buf.push(\"learn: [[\", (__stack.lineno = 63, reward), \"]]\\n\");\n                        __stack.lineno = 64;\n                    });\n                    buf.push(\"\\n\");\n                    __stack.lineno = 65;\n                    q.buffRewards.forEach(function(reward, index) {\n                        buf.push(\"The following spell will be cast on you: [[\", (__stack.lineno = 65, reward), \"]]\\n\\n\");\n                        __stack.lineno = 67;\n                    });\n                    buf.push(\"\");\n                    __stack.lineno = 67;\n                    if (q.money) {\n                        buf.push(\"You will \");\n                        __stack.lineno = 67;\n                        if (q.hasChoiceAbilityOrBuffRewards()) {\n                            buf.push(\"also \");\n                            __stack.lineno = 67;\n                        }\n                        buf.push(\"receive: {{cost|\", (__stack.lineno = 67, q.getGold()), \"|\", (__stack.lineno = 67, q.getSilver()), \"|\", (__stack.lineno = 67, q.getCopper()), \"}}\\n\");\n                        __stack.lineno = 68;\n                    }\n                    buf.push(\"\");\n                    __stack.lineno = 68;\n                    if (q.nonChoiceRewards.length) {\n                        buf.push(\"{{itembox|\");\n                        __stack.lineno = 68;\n                        if (!q.money) {\n                            buf.push(\"You will \");\n                            __stack.lineno = 68;\n                            if (q.hasChoiceAbilityOrBuffRewards()) {\n                                buf.push(\"also \");\n                                __stack.lineno = 68;\n                            }\n                            buf.push(\"receive:\");\n                            __stack.lineno = 68;\n                        }\n                        buf.push(\"\");\n                        __stack.lineno = 68;\n                        q.nonChoiceRewards.forEach(function(reward, index) {\n                            buf.push(\"\");\n                            __stack.lineno = 68;\n                            if (reward.quantity) {\n                                buf.push(\"|q\", (__stack.lineno = 68, index + 1), \"=\", (__stack.lineno = 68, reward.quantity), \"\");\n                                __stack.lineno = 68;\n                            }\n                            buf.push(\"|\", (__stack.lineno = 68, reward.name), \"\\n\");\n                            __stack.lineno = 69;\n                        });\n                        buf.push(\"}}\\n\\n\");\n                        __stack.lineno = 71;\n                    }\n                    buf.push(\"\");\n                    __stack.lineno = 71;\n                }\n                buf.push(\"\\n\");\n                __stack.lineno = 72;\n                if (q.progress) {\n                    buf.push(\"==Progress==\\n\", (__stack.lineno = 73, q.progress), \"\\n\\n\");\n                    __stack.lineno = 75;\n                }\n                buf.push(\"\");\n                __stack.lineno = 75;\n                if (q.completion) {\n                    buf.push(\"==Completion==\\n\", (__stack.lineno = 76, q.completion), \"\\n\");\n                    __stack.lineno = 77;\n                }\n                buf.push(\"\\n\");\n                __stack.lineno = 78;\n                if (q.hasGains()) {\n                    buf.push(\"==Gains==\\n\");\n                    __stack.lineno = 79;\n                    if (q.experience) {\n                        buf.push(\"* \", (__stack.lineno = 79, q.getExperienceStr()), \" [[XP]]\\n\");\n                        __stack.lineno = 80;\n                    }\n                    buf.push(\"\");\n                    __stack.lineno = 80;\n                    q.reputationGains.forEach(function(gain) {\n                        buf.push(\"* \", (__stack.lineno = 80, gain.getFullText()), \"\\n\");\n                        __stack.lineno = 81;\n                    });\n                    buf.push(\"\");\n                    __stack.lineno = 81;\n                }\n                buf.push(\"\");\n                __stack.lineno = 81;\n                q.otherGains.forEach(function(gain) {\n                    buf.push(\"* \", (__stack.lineno = 81, gain), \"\\n\");\n                    __stack.lineno = 82;\n                });\n                buf.push(\"\\n==Progression==\\n...\\n\");\n                __stack.lineno = 85;\n                if (q.patchAdded) {\n                    buf.push(\"\\n==Patch changes==\\n* {{Patch \", (__stack.lineno = 87, q.patchAdded), \"|note=Added.}}\\n\");\n                    __stack.lineno = 88;\n                }\n                buf.push(\"\\n==External links==\\n{{subst:el}}\\n{{Elinks-quest|\", (__stack.lineno = 91, q.id), \"}}\\n\");\n            })();\n        }\n        return buf.join(\"\");\n    } catch (err) {\n        rethrow(err, __stack.input, __stack.filename, __stack.lineno);\n    }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./templates/quest.ejs\n// module id = 9\n// module chunks = 0","import ItemReward from \"../core/ItemReward\";\n\nexport default class Quest {\n\tconstructor() {\n\t\tthis.stages = [];\n\t\tthis.providedItems = [];\n\n\t\tthis.choiceRewards = [];\n\t\tthis.nonChoiceRewards = [];\n\t\tthis.abilityRewards = [];\n\t\tthis.buffRewards = [];\n\n\t\tthis.reputationGains = [];\n\t\tthis.otherGains = [];\n\n\t\tthis.previousQuests = [];\n\t\tthis.nextQuests = [];\n\t}\n\n\tgetGold() {\n\t\treturn Math.floor(this.money / 10000) || \"\";\n\t}\n\n\tgetSilver() {\n\t\treturn (Math.floor(this.money / 100) % 100) || \"\";\n\t}\n\n\tgetCopper() {\n\t\treturn (this.money % 100) || \"\";\n\t}\n\t\n\thasItemRewards() {\n\t\treturn this.choiceRewards.length > 0 || this.nonChoiceRewards.length > 0;\n\t}\n\t\n\tgetAllNonChoiceRewards() {\n\t\tlet result = this.nonChoiceRewards.slice();\n\t\t\n\t\t// These are not actually item rewards, but the formatter will behave as if they're items with unknown quantity\n\t\tfunction insertReward(reward) {\n\t\t\tresult.push(new ItemReward(reward, null, result.length + 1));\n\t\t}\n\n\t\tthis.abilityRewards.forEach(insertReward);\n\t\tthis.buffRewards.forEach(insertReward);\n\t\treturn result;\n\t}\n\t\n\thasChoiceAbilityOrBuffRewards() {\n\t\treturn this.choiceRewards.length > 0 || this.abilityRewards.length > 0 || this.buffRewards.length > 0;\n\t}\n\t\n\thasNonMoneyRewards() {\n\t\treturn this.hasItemRewards() || this.abilityRewards.length > 0 || this.buffRewards.length > 0;\n\t}\n\t\n\thasRewards() {\n\t\treturn !!this.money || this.hasNonMoneyRewards();\n\t}\n\n\tgetExperienceStr() {\n\t\treturn new Intl.NumberFormat(\"en-US\").format(this.experience);\n\t}\n\t\n\thasGains() {\n\t\treturn !!this.experience || this.reputationGains.length > 0;\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./model/quest/Quest.js\n// module id = 10\n// module chunks = 0","export default class ReputationGain {\n\t/**\n\t * \n\t * @param {string} faction \n\t * @param {number} canonicalName \n\t * @param {number} gain\n\t */\n\tconstructor(faction, canonicalName, gain) {\n\t\tthis.faction = faction;\n\t\tthis.canonicalName = canonicalName;\n\t\tthis.gain = gain;\n\t}\n\n\t/**\n\t * @return {string}\n\t */\n\tgetLink() {\n\t\tif (this.canonicalName == null) {\n\t\t\treturn \"[[\" + this.faction + \"]]\";\n\t\t} else {\n\t\t\treturn \"[[\" + this.canonicalName + \"|\" + this.faction + \"]]\";\n\t\t}\n\t}\n\n\t/**\n\t * @return {string}\n\t */\n\tgetFullText() {\n\t\treturn \"+\" + this.gain + \" reputation with \" + this.getLink();\n\t}\n\n\t/**\n\t * @return {string}\n\t */\n\ttoString() {\n\t\treturn \"+\" + this.gain + \" \" + this.getLink();\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./model/quest/ReputationGain.js\n// module id = 11\n// module chunks = 0","import { $, $$ } from \"../common/shortcuts\";\nimport u from \"./utils\";\nimport substitutions from \"./substitutions\";\n\nimport missionEJS from \"../templates/mission.ejs\";\n\nimport Mission from \"../model/mission/Mission\";\nimport GarrisonMission from \"../model/mission/GarrisonMission\";\nimport NavalMission from \"../model/mission/NavalMission\";\nimport ClassHallMission from \"../model/mission/ClassHallMission\";\nimport MissionEnemy from \"../model/mission/MissionEnemy\";\nimport ItemReward from \"../model/core/ItemReward\";\n\n// Magic numbers from breadcrumb bar\nconst MISSION_SYSTEM_GARRISONS = 21;\nconst MISSION_SYSTEM_CLASS_HALLS = 30;\nconst MISSION_UNIT_FOLLOWERS = 1;\nconst MISSION_UNIT_SHIPS = 2;\n\n/**\n * @param {ParserContext} context \n */\nexport default function MissionParser(context) {\n\tthis.context = context;\n\tthis.templatePrefix = \"m\";\n\tthis.template = missionEJS;\n\n\t/**\n\t * @return {Mission}\n\t */\n\tthis.parse = function() {\n\t\tlet mission = createMissionOfCorrectType();\n\t\t\n\t\tlet url = $(\"link[rel=canonical]\").getAttribute(\"href\");\n\t\tlet idStr = u.getRegexGroup(url, \"/mission=([0-9]+)/\", 1);\n\t\tmission.id = parseInt(idStr, 10);\n\t\t\n\t\tlet mainContainer = $(\"#main-contents > div.text\");\n\t\tmission.name = mainContainer.querySelector(\"h1.heading-size-1\").textContent.trim();\n\n\t\tparseDescription(mission, mainContainer);\n\t\tparseEncounters(mission, mainContainer);\n\t\tparseCost(mission, mainContainer);\n\t\tparseGains(mission, mainContainer);\n\t\tparseRewards(mission, mainContainer);\n\t\tparseInfobox(mission);\n\n\t\treturn mission;\n\t}\n\n\tfunction createMissionOfCorrectType() {\n\t\tlet categoryIds = u.getCategoryIds();\n\t\t\n\t\tif (categoryIds[1] === MISSION_SYSTEM_CLASS_HALLS) {\n\t\t\treturn new ClassHallMission();\n\t\t}\n\n\t\tswitch (categoryIds[3]) {\n\t\tcase MISSION_UNIT_FOLLOWERS:\n\t\t\treturn new GarrisonMission();\n\t\tcase MISSION_UNIT_SHIPS:\n\t\t\treturn new NavalMission();\n\t\tdefault:\n\t\t\tthrow new Error();\n\t\t}\n\t}\n\n\t/**\n\t * \n\t * @param {Mission} mission \n\t * @param {Element} mainContainer \n\t */\n\tfunction parseDescription(mission, mainContainer) {\n\t\tlet headingsSize3 = mainContainer.querySelectorAll(\"h2.heading-size-3\");\n\n\t\tu.getFirstWithOwnText(headingsSize3, \"Description\", descriptionHeading => {\n\t\t\tmission.description = u.normalize(u.collectTextUntilNextTag(descriptionHeading, \"h2\"));\n\t\t});\n\t}\n\n\n\t/**\n\t * \n\t * @param {Mission} mission \n\t * @param {Element} mainContainer \n\t */\n\tfunction parseEncounters(mission, mainContainer) {\n\t\tlet useLegionThreats = mission instanceof ClassHallMission;\n\t\t\n\t\tfor (let td of mainContainer.querySelectorAll(\"td.garrison-encounter-enemy\")) {\n\t\t\tif (td.classList.contains(\"empty\")) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tlet enemyName = u.normalize(td.querySelector(\"span.garrison-encounter-enemy-name\").textContent);\n\t\t\tlet enemyCounters = [];\n\t\t\t\n\t\t\tfor (let mechanic of td.querySelectorAll(\"div.garrison-encounter-enemy-mechanic\")) {\n\t\t\t\tif (useLegionThreats) {\n\t\t\t\t\t// Try to parse Legion mission counter, if available\n\t\t\t\t\tlet abilityLink = mechanic.getAttribute(\"data-href\");\n\t\t\t\t\tlet abilityStr = u.getRegexGroup(abilityLink, \"/mission-ability=([0-9]+)\", 1);\n\t\t\t\t\t\n\t\t\t\t\tif (abilityStr) {\n\t\t\t\t\t\tlet mechanicId = parseInt(abilityStr, 10);\n\t\t\t\t\t\tenemyCounters.push(context.legionMissionMechanics[mechanicId]);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// Fallback\n\t\t\t\tlet mechanicId = parseInt(mechanic.getAttribute(\"data-mechanic\"), 10);\n\t\t\t\tenemyCounters.push(context.missionMechanics[mechanicId]);\n\t\t\t}\n\t\t\t\n\t\t\tmission.enemies.push(new MissionEnemy(enemyName, enemyCounters));\n\t\t}\n\t}\n\n\t/**\n\t * \n\t * @param {Mission} mission \n\t * @param {Element} mainContainer \n\t */\n\tfunction parseCost(mission, mainContainer) {\n\t\tlet headingsSize3 = mainContainer.querySelectorAll(\"h2.heading-size-3\");\n\t\t\n\t\t// Find the icontab that describes the mission cost\n\t\tu.getFirstWithOwnText(headingsSize3, \"Cost\", costHeading => {\n\t\t\tlet icontab = costHeading;\n\t\t\t\n\t\t\tdo {\n\t\t\t\ticontab = icontab.nextElementSibling;\n\t\t\t} while (u.tagName(icontab) !== \"table\" || !icontab.classList.contains(\"icontab\"));\n\t\t\t\n\t\t\t// Mission cost is the quantity of the only item in the icontab\n\t\t\tu.collectItemRewards(icontab, (item, quantity) => mission.cost = quantity);\n\t\t});\n\t}\n\n\t/**\n\t * \n\t * @param {Mission} mission \n\t * @param {Element} mainContainer \n\t */\n\tfunction parseGains(mission, mainContainer) {\n\t\tlet headingsSize3 = mainContainer.querySelectorAll(\"h2.heading-size-3\");\n\t\tlet gainsList;\n\t\t\n\t\tu.getFirstWithOwnText(headingsSize3, \"Gains\", heading => {\n\t\t\tgainsList = u.findNextElementSibling(heading, el => u.tagName(el) === \"ul\");\n\t\t});\n\t\t\n\t\tif (gainsList) {\n\t\t\tfor (let li of gainsList.getElementsByTagName(\"li\")) {\n\t\t\t\tlet text = u.normalize(li.textContent);\n\t\t\t\tlet maybeXP = u.getRegexGroup(text, \"([0-9,]*) experience\", 1);\n\t\t\t\t\n\t\t\t\tif (maybeXP) {\n\t\t\t\t\tmission.followerXP = parseInt(maybeXP.replace(\",\", \"\"));\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * \n\t * @param {Mission} mission \n\t * @param {Element} mainContainer \n\t */\n\tfunction parseRewards(mission, mainContainer) {\n\t\tlet headingsSize3 = mainContainer.querySelectorAll(\"h2.heading-size-3\");\n\t\t\n\t\tu.getFirstWithOwnText(headingsSize3, \"Rewards\", rewardsHeading => {\n\t\t\t// Look through everything between Rewards and the next header (or end of parent)\n\t\t\tfor (let el = rewardsHeading.nextElementSibling;\n\t\t\t\t\tel !== null && !(u.tagName(el) === \"h3\" && el.classList.contains(\"heading-size-3\"));\n\t\t\t\t\tel = el.nextElementSibling) {\n\t\t\t\tif (u.tagName(el) === \"table\" && el.classList.contains(\"icontab\")) {\n\t\t\t\t\tparseItemRewards(mission, el);\n\t\t\t\t} else if (u.tagName(el) === \"ul\") {\n\t\t\t\t\t// Non-item rewards\n\t\t\t\t\tparseNonItemRewards(mission, el.getElementsByTagName(\"li\"));\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\t\n\t/**\n\t * \n\t * @param {Mission} mission \n\t * @param {Element} icontab \n\t */\n\tfunction parseItemRewards(mission, icontab) {\n\t\tu.collectItemRewards(icontab, (item, quantity) => {\n\t\t\tif (item === mission.getResourceName()) {\n\t\t\t\tmission.bonusResources = quantity;\n\t\t\t} else {\n\t\t\t\tmission.bonusItems.push(new ItemReward(item, quantity, mission.bonusItems.length + 1));\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * \n\t * @param {Mission} mission \n\t * @param {Array.<Element>} listItems\n\t */\n\tfunction parseNonItemRewards(mission, listItems) {\n\t\t// This is a bit messy because Wowhead lumps all rewards together\n\t\tfor (let li of listItems) {\n\t\t\tlet text = u.normalize(li.textContent);\n\t\t\tlet maybeXP = u.getRegexGroup(text, \"([0-9,]*) experience\", 1);\n\t\t\t\n\t\t\tif (maybeXP) {\n\t\t\t\tmission.bonusXP = parseInt(maybeXP.replace(\",\", \"\"));\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tlet money = u.getMoney(li);\n\t\t\t\n\t\t\tif (money !== 0) {\n\t\t\t\tmission.bonusMoney = money;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction parseInfobox(mission) {\n\t\t// Infobox section\n\t\t// Pattern-match each infobox line\n\t\tfor (let infoboxLine of u.getInfoboxLines(true)) {\n\t\t\tif (infoboxLine.startsWith(\"Rare\")) {\n\t\t\t\tmission.rare = true;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tif (infoboxLine.startsWith(\"Exhausting\")) {\n\t\t\t\tmission.exhausting = true;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Level: ([0-9]+)\", 1, levelStr => {\n\t\t\t\tmission.level = parseInt(levelStr);\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Required item level: ([0-9]+)\", 1, levelStr => {\n\t\t\t\tmission.followerItemLevel = parseInt(levelStr);\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Location: (.+)\", 1, location => {\n\t\t\t\tmission.location = location;\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Duration: (.+)\", 1, duration => {\n\t\t\t\tmission.duration = duration;\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Type: (.+)\", 1, type => {\n\t\t\t\tmission.type = type;\n\t\t\t});\n\n\t\t\tu.getRegexGroup(infoboxLine, \"Category: (.+)\", 1, category => {\n\t\t\t\tmission.category = category;\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Class: ([0-9]+)\", 1, classId => {\n\t\t\t\tmission.characterClass = context.classes[classId];\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Added in patch ([0-9]+.[0-9]+.[0-9]+)\", 1, patch => {\n\t\t\t\tmission.patchAdded = substitutions.getCanonicalPatchVersion(patch);\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"(?:Followers|Champions|Ships): ([0-9]+)\", 1, groupSize => {\n\t\t\t\tmission.groupSize = parseInt(groupSize);\n\t\t\t});\n\t\t}\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./parsers/MissionParser.js\n// module id = 12\n// module chunks = 0","module.exports = function anonymous(locals, filters, escape, rethrow) {\n    escape = escape || function(html) {\n        return String(html).replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/'/g, \"&#39;\").replace(/\"/g, \"&quot;\");\n    };\n    var __stack = {\n        lineno: 1,\n        input: \"{{<%- m.getInfoboxTemplate() %>\\n | id = <%- m.id %>\\n | name = <%- m.name %>\\n | location = <%- m.location %>\\n<% if (m.faction) { -%>\\n | faction = <%- m.faction %>\\n<% } -%>\\n<% if (m.characterClass) { -%>\\n | class = <%- m.characterClass %>\\n<% } -%>\\n | level = <%- m.level %>\\n<% if (m.followerItemLevel) { -%>\\n | flevel = <%- m.followerItemLevel %>\\n<% } -%>\\n<% if (m.rare) { -%>\\n | rare = yes\\n<% } -%>\\n<% if (m.exhausting) { -%>\\n | exhausting = yes\\n<% } -%>\\n | duration = <%- m.duration %>\\n<% if (m.groupSize) { -%>\\n | groupsize = <%- m.groupSize %>\\n<% } -%>\\n | type = <%- m.category %>\\n | enemies = <% m.enemies.forEach(function(enemy, index) { %><%- enemy.name %><% if (index < m.enemies.length - 1) { %><br /><% } }) %>\\n<% if (m.cost) { -%>\\n | cost = <%- m.cost %>\\n<% } -%>\\n<% if (m.followerXP) { -%>\\n | experience = <%- m.getFollowerXPStr() %>\\n<% } -%>\\n<% if (m.money) { -%>\\n | bonusgold = {{cost|<%- m.getGold() %>|<%- m.getSilver() %>|<%- m.getCopper() %>}}\\n<% } -%>\\n<% if (m.bonusXP) { -%>\\n | bonusxp = <%- m.getBonusXPStr() %>\\n<% } -%>\\n<% if (m.bonusResources) { -%>\\n | bonusresources = <%- m.bonusResources %>\\n<% } -%>\\n<% if (m.bonusItems.length) { -%>\\n | bonusitem = <% m.bonusItems.forEach(function(item, index) { %><% if (item.quantity) { %><%- item.quantity %>x <% } %>[[<%- item.name %>]]<% if (index < m.bonusItems.length - 1) { %><br /><% } }) %>\\n<% } -%>\\n}}\\n\\n==Description==\\n<% if (m.description) { -%>\\n<%- m.description %>\\n<% } else { -%>\\n...\\n<% } -%>\\n\\n==Counters==\\n<% if (m.type) { -%>\\n* Type: {{Garrison ability|<%- m.type %>}}\\n<% } -%>\\n<% m.enemies.forEach(function(enemy) { -%>\\n* <%- enemy.name %>:<% enemy.counters.forEach(function(counter) { %> {{Garrison ability|<%- counter %>}}<% }) %>\\n<% }) -%>\\n<% if (m.followerXP) { -%>\\n\\n==Gains==\\n* <%- m.getFollowerXPStr() %> follower XP\\n<% } -%>\\n\\n<% if (m.hasRewards()) { -%>\\n==Rewards==\\n<% if (m.bonusItems.length) { -%>\\n{{itembox|You will receive:\\n<% m.bonusItems.forEach(function(item, index) { -%>\\n<% if (item.quantity) { %>|q<%- (index + 1) %>=<%- item.quantity %><% } %>|<%- item.name %>\\n<% }) -%>\\n}}\\n<% } -%>\\n\\n<% if (m.hasNonItemRewards()) { -%>\\nYou will <% if (m.bonusItems.length) { -%>also <% } -%>receive:\\n<% if (m.bonusXP) { -%>\\n* <%- m.getBonusXPStr() %> bonus follower XP\\n<% } -%>\\n<% if (m.money) { -%>\\n* {{cost|<%- m.getGold() %>|<%- m.getSilver() %>|<%- m.getCopper() %>}}\\n<% } -%>\\n<% if (m.bonusResources) { -%>\\n* [[<%- m.getResourceName() %>]] (<%- m.bonusResources %>)\\n\\n<% } -%>\\n<% } -%>\\n<% } -%>\\n<% if (m.patchAdded) { -%>\\n==Patch changes==\\n* {{Patch <%- m.patchAdded %>|note=Added.}}\\n\\n<% } -%>\\n==External links==\\n{{subst:el}}\\n{{Elinks-mission|<%- m.id %>}}\\n\",\n        filename: \".\"\n    };\n    function rethrow(err, str, filename, lineno) {\n        var lines = str.split(\"\\n\"), start = Math.max(lineno - 3, 0), end = Math.min(lines.length, lineno + 3);\n        var context = lines.slice(start, end).map(function(line, i) {\n            var curr = i + start + 1;\n            return (curr == lineno ? \" >> \" : \"    \") + curr + \"| \" + line;\n        }).join(\"\\n\");\n        err.path = filename;\n        err.message = (filename || \"ejs\") + \":\" + lineno + \"\\n\" + context + \"\\n\\n\" + err.message;\n        throw err;\n    }\n    try {\n        var buf = [];\n        with (locals || {}) {\n            (function() {\n                buf.push(\"{{\", (__stack.lineno = 1, m.getInfoboxTemplate()), \"\\n | id = \", (__stack.lineno = 2, m.id), \"\\n | name = \", (__stack.lineno = 3, m.name), \"\\n | location = \", (__stack.lineno = 4, m.location), \"\\n\");\n                __stack.lineno = 5;\n                if (m.faction) {\n                    buf.push(\" | faction = \", (__stack.lineno = 5, m.faction), \"\\n\");\n                    __stack.lineno = 6;\n                }\n                buf.push(\"\");\n                __stack.lineno = 6;\n                if (m.characterClass) {\n                    buf.push(\" | class = \", (__stack.lineno = 6, m.characterClass), \"\\n\");\n                    __stack.lineno = 7;\n                }\n                buf.push(\" | level = \", (__stack.lineno = 7, m.level), \"\\n\");\n                __stack.lineno = 8;\n                if (m.followerItemLevel) {\n                    buf.push(\" | flevel = \", (__stack.lineno = 8, m.followerItemLevel), \"\\n\");\n                    __stack.lineno = 9;\n                }\n                buf.push(\"\");\n                __stack.lineno = 9;\n                if (m.rare) {\n                    buf.push(\" | rare = yes\\n\");\n                    __stack.lineno = 10;\n                }\n                buf.push(\"\");\n                __stack.lineno = 10;\n                if (m.exhausting) {\n                    buf.push(\" | exhausting = yes\\n\");\n                    __stack.lineno = 11;\n                }\n                buf.push(\" | duration = \", (__stack.lineno = 11, m.duration), \"\\n\");\n                __stack.lineno = 12;\n                if (m.groupSize) {\n                    buf.push(\" | groupsize = \", (__stack.lineno = 12, m.groupSize), \"\\n\");\n                    __stack.lineno = 13;\n                }\n                buf.push(\" | type = \", (__stack.lineno = 13, m.category), \"\\n | enemies = \");\n                __stack.lineno = 14;\n                m.enemies.forEach(function(enemy, index) {\n                    buf.push(\"\", (__stack.lineno = 14, enemy.name), \"\");\n                    __stack.lineno = 14;\n                    if (index < m.enemies.length - 1) {\n                        buf.push(\"<br />\");\n                        __stack.lineno = 14;\n                    }\n                });\n                buf.push(\"\\n\");\n                __stack.lineno = 15;\n                if (m.cost) {\n                    buf.push(\" | cost = \", (__stack.lineno = 15, m.cost), \"\\n\");\n                    __stack.lineno = 16;\n                }\n                buf.push(\"\");\n                __stack.lineno = 16;\n                if (m.followerXP) {\n                    buf.push(\" | experience = \", (__stack.lineno = 16, m.getFollowerXPStr()), \"\\n\");\n                    __stack.lineno = 17;\n                }\n                buf.push(\"\");\n                __stack.lineno = 17;\n                if (m.money) {\n                    buf.push(\" | bonusgold = {{cost|\", (__stack.lineno = 17, m.getGold()), \"|\", (__stack.lineno = 17, m.getSilver()), \"|\", (__stack.lineno = 17, m.getCopper()), \"}}\\n\");\n                    __stack.lineno = 18;\n                }\n                buf.push(\"\");\n                __stack.lineno = 18;\n                if (m.bonusXP) {\n                    buf.push(\" | bonusxp = \", (__stack.lineno = 18, m.getBonusXPStr()), \"\\n\");\n                    __stack.lineno = 19;\n                }\n                buf.push(\"\");\n                __stack.lineno = 19;\n                if (m.bonusResources) {\n                    buf.push(\" | bonusresources = \", (__stack.lineno = 19, m.bonusResources), \"\\n\");\n                    __stack.lineno = 20;\n                }\n                buf.push(\"\");\n                __stack.lineno = 20;\n                if (m.bonusItems.length) {\n                    buf.push(\" | bonusitem = \");\n                    __stack.lineno = 20;\n                    m.bonusItems.forEach(function(item, index) {\n                        buf.push(\"\");\n                        __stack.lineno = 20;\n                        if (item.quantity) {\n                            buf.push(\"\", (__stack.lineno = 20, item.quantity), \"x \");\n                            __stack.lineno = 20;\n                        }\n                        buf.push(\"[[\", (__stack.lineno = 20, item.name), \"]]\");\n                        __stack.lineno = 20;\n                        if (index < m.bonusItems.length - 1) {\n                            buf.push(\"<br />\");\n                            __stack.lineno = 20;\n                        }\n                    });\n                    buf.push(\"\\n\");\n                    __stack.lineno = 21;\n                }\n                buf.push(\"}}\\n\\n==Description==\\n\");\n                __stack.lineno = 24;\n                if (m.description) {\n                    buf.push(\"\", (__stack.lineno = 24, m.description), \"\\n\");\n                    __stack.lineno = 25;\n                } else {\n                    buf.push(\"...\\n\");\n                    __stack.lineno = 26;\n                }\n                buf.push(\"\\n==Counters==\\n\");\n                __stack.lineno = 28;\n                if (m.type) {\n                    buf.push(\"* Type: {{Garrison ability|\", (__stack.lineno = 28, m.type), \"}}\\n\");\n                    __stack.lineno = 29;\n                }\n                buf.push(\"\");\n                __stack.lineno = 29;\n                m.enemies.forEach(function(enemy) {\n                    buf.push(\"* \", (__stack.lineno = 29, enemy.name), \":\");\n                    __stack.lineno = 29;\n                    enemy.counters.forEach(function(counter) {\n                        buf.push(\" {{Garrison ability|\", (__stack.lineno = 29, counter), \"}}\");\n                        __stack.lineno = 29;\n                    });\n                    buf.push(\"\\n\");\n                    __stack.lineno = 30;\n                });\n                buf.push(\"\");\n                __stack.lineno = 30;\n                if (m.followerXP) {\n                    buf.push(\"\\n==Gains==\\n* \", (__stack.lineno = 32, m.getFollowerXPStr()), \" follower XP\\n\");\n                    __stack.lineno = 33;\n                }\n                buf.push(\"\\n\");\n                __stack.lineno = 34;\n                if (m.hasRewards()) {\n                    buf.push(\"==Rewards==\\n\");\n                    __stack.lineno = 35;\n                    if (m.bonusItems.length) {\n                        buf.push(\"{{itembox|You will receive:\\n\");\n                        __stack.lineno = 36;\n                        m.bonusItems.forEach(function(item, index) {\n                            buf.push(\"\");\n                            __stack.lineno = 36;\n                            if (item.quantity) {\n                                buf.push(\"|q\", (__stack.lineno = 36, index + 1), \"=\", (__stack.lineno = 36, item.quantity), \"\");\n                                __stack.lineno = 36;\n                            }\n                            buf.push(\"|\", (__stack.lineno = 36, item.name), \"\\n\");\n                            __stack.lineno = 37;\n                        });\n                        buf.push(\"}}\\n\");\n                        __stack.lineno = 38;\n                    }\n                    buf.push(\"\\n\");\n                    __stack.lineno = 39;\n                    if (m.hasNonItemRewards()) {\n                        buf.push(\"You will \");\n                        __stack.lineno = 39;\n                        if (m.bonusItems.length) {\n                            buf.push(\"also \");\n                            __stack.lineno = 39;\n                        }\n                        buf.push(\"receive:\");\n                        __stack.lineno = 39;\n                        if (m.bonusXP) {\n                            buf.push(\"* \", (__stack.lineno = 39, m.getBonusXPStr()), \" bonus follower XP\\n\");\n                            __stack.lineno = 40;\n                        }\n                        buf.push(\"\");\n                        __stack.lineno = 40;\n                        if (m.money) {\n                            buf.push(\"* {{cost|\", (__stack.lineno = 40, m.getGold()), \"|\", (__stack.lineno = 40, m.getSilver()), \"|\", (__stack.lineno = 40, m.getCopper()), \"}}\\n\");\n                            __stack.lineno = 41;\n                        }\n                        buf.push(\"\");\n                        __stack.lineno = 41;\n                        if (m.bonusResources) {\n                            buf.push(\"* [[\", (__stack.lineno = 41, m.getResourceName()), \"]] (\", (__stack.lineno = 41, m.bonusResources), \")\\n\\n\");\n                            __stack.lineno = 43;\n                        }\n                        buf.push(\"\");\n                        __stack.lineno = 43;\n                    }\n                    buf.push(\"\");\n                    __stack.lineno = 43;\n                }\n                buf.push(\"\");\n                __stack.lineno = 43;\n                if (m.patchAdded) {\n                    buf.push(\"==Patch changes==\\n* {{Patch \", (__stack.lineno = 44, m.patchAdded), \"|note=Added.}}\\n\\n\");\n                    __stack.lineno = 46;\n                }\n                buf.push(\"==External links==\\n{{subst:el}}\\n{{Elinks-mission|\", (__stack.lineno = 48, m.id), \"}}\\n\");\n            })();\n        }\n        return buf.join(\"\");\n    } catch (err) {\n        rethrow(err, __stack.input, __stack.filename, __stack.lineno);\n    }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./templates/mission.ejs\n// module id = 13\n// module chunks = 0","import Mission from \"./Mission\";\n\nexport default class GarrisonMission extends Mission {\n\tgetInfoboxTemplate() {\n\t\treturn \"Missionbox\";\n\t}\n\n\tgetResourceName() {\n\t\treturn \"Garrison Resources\";\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./model/mission/GarrisonMission.js\n// module id = 14\n// module chunks = 0","import Mission from \"./Mission\";\n\nexport default class NavalMission extends Mission {\n\tgetInfoboxTemplate() {\n\t\treturn \"Navalbox\";\n\t}\n\n\tgetResourceName() {\n\t\treturn \"Oil\";\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./model/mission/NavalMission.js\n// module id = 15\n// module chunks = 0","import Mission from \"./Mission\";\n\nexport default class ClassHallMission extends Mission {\n\tgetInfoboxTemplate() {\n\t\treturn \"MissionLegionbox\";\n\t}\n\n\tgetResourceName() {\n\t\treturn \"Order Resources\";\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./model/mission/ClassHallMission.js\n// module id = 16\n// module chunks = 0","export default class MissionEnemy {\n\t/**\n\t * \n\t * @param {string} name \n\t * @param {Array.<string>} counters \n\t */\n\tconstructor(name, counters) {\n\t\tthis.name = name;\n\t\tthis.counters = counters.slice();\n\t}\n\n\ttoString() {\n\t\treturn this.name + \" \" + this.counters;\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./model/mission/MissionEnemy.js\n// module id = 17\n// module chunks = 0","import { $, $$ } from \"../common/shortcuts\";\nimport u from \"./utils\";\nimport substitutions from \"./substitutions\";\n\nimport npcEJS from \"../templates/npc.ejs\";\n\nimport NPC from \"../model/npc/NPC\";\nimport NPCQuest from \"../model/npc/NPCQuest\";\nimport SoldItem from \"../model/npc/SoldItem\";\n\n/**\n * @param {ParserContext} context \n */\nexport default function NPCParser(context) {\n\tthis.context = context;\n\tthis.templatePrefix = \"n\";\n\tthis.template = npcEJS;\n\n\t/**\n\t * @return {NPC}\n\t */\n\tthis.parse = function() {\n\t\tlet npc = new NPC();\n\t\t\n\t\tlet url = $(\"link[rel=canonical]\").getAttribute(\"href\");\n\t\tlet idStr = u.getRegexGroup(url, \"/npc=([0-9]+)/\", 1);\n\t\tnpc.id = parseInt(idStr, 10);\n\t\t\n\t\tlet mainContainer = $(\"#main-contents > div.text\");\n\t\tlet npcName = mainContainer.querySelector(\"h1.heading-size-1\").textContent;\n\t\t\n\t\tnpc.name = npcName.replace(/<.*>/g, \"\").trim();\n\t\t\n\t\t// If we have a title\n\t\tu.getRegexGroup(npcName, \"<(.*)>\", 1, title => {\n\t\t\tnpc.title = title;\n\t\t});\n\t\t\n\t\tparseCreatureType(npc);\n\t\tparseLocation(npc, mainContainer);\n\t\tparseLists(npc);\n\t\tparseQuotes(npc, mainContainer);\n\t\tparseHealth(npc);\n\t\tparseInfobox(npc);\n\n\t\treturn npc;\n\t}\n\n\t/**\n\t * @param {NPC} npc \n\t */\n\tfunction parseCreatureType(npc) {\n\t\tlet categoryIds = u.getCategoryIds();\n\t\t// third number in list is the creature type id\n\t\tlet creatureTypeId = categoryIds[2];\n\t\tnpc.creatureType = context.npcTypes[creatureTypeId.toString()];\n\t}\n\t\n\t/**\n\t * @param {NPC} npc \n\t * @param {Element} mainContainer\n\t */\n\tfunction parseLocation(npc, mainContainer) {\n\t\tlet locationLink = mainContainer.querySelector(\"#locations a\");\n\t\t\n\t\tif (locationLink) {\n\t\t\tnpc.location = locationLink.textContent;\n\t\t}\n\t}\n\t\n\t/**\n\t * @param {NPC} npc \n\t */\n\tfunction parseLists(npc) {\n\t\tu.getElementContainingOwnText(document, \"script\", \"new Listview\", script => {\n\t\t\tparseQuests(npc, script.textContent);\n\t\t\tparseItems(npc, script.textContent);\n\t\t\tparseSounds(npc, script.textContent);\n\t\t});\n\t}\n\t\n\t/**\n\t * @param {NPC} npc \n\t * @param {string} script\n\t */\n\tfunction parseQuests(npc, script) {\n\t\tlet startsQuests = new Set();\n\t\t\n\t\tu.getRegexGroup(script, \"new Listview\\\\(\\\\{template: 'quest', id: 'starts', (.*)\\\\);\", 1, s => {\n\t\t\taddQuests(startsQuests, s);\n\t\t});\n\t\t\n\t\tlet finishesQuests = new Set();\n\t\t\n\t\tu.getRegexGroup(script, \"new Listview\\\\(\\\\{template: 'quest', id: 'ends', (.*)\\\\);\", 1, s => {\n\t\t\taddQuests(finishesQuests, s);\n\t\t});\n\t\t\n\t\t// Split all quests into three groups: starts, finishes, both \n\t\tlet startsAndFinishesQuests = new Set();\n\t\t\n\t\tfor (let quest of startsQuests) {\n\t\t\tif (finishesQuests.has(quest)) {\n\t\t\t\tstartsAndFinishesQuests.add(quest);\n\t\t\t}\n\t\t}\n\n\t\tfor (let quest of startsAndFinishesQuests) {\n\t\t\tstartsQuests.delete(quest);\n\t\t\tfinishesQuests.delete(quest);\n\t\t};\n\t\t\n\t\tlet quests = [];\n\t\t\n\t\tfor (let quest of startsAndFinishesQuests) {\n\t\t\tquests.push(new NPCQuest(quest, true, true));\n\t\t}\n\t\t\n\t\tfor (let quest of startsQuests) {\n\t\t\tquests.push(new NPCQuest(quest, true, false));\n\t\t}\n\t\t\n\t\tfor (let quest of finishesQuests) {\n\t\t\tquests.push(new NPCQuest(quest, false, true));\n\t\t}\n\t\t\n\t\tquests.sort((q1, q2) => q1.compareTo(q2));\n\t\tnpc.quests = quests;\n\t}\n\t\n\t/**\n\t * \n\t * @param {Set} quests \n\t * @param {string} jsPart \n\t */\n\tfunction addQuests(quests, jsPart) {\n\t\t// Extract the name field from every quest in the list\n\t\tlet regex = /\"name\":\"([^\"]+)\"/g;\n\t\tlet match;\n\t\t\n\t\twhile ((match = regex.exec(jsPart)) !== null) {\n\t\t\tquests.add(match[1]);\n\t\t}\n\t}\n\t\n\t/**\n\t * @param {NPC} npc \n\t * @param {string} script\n\t */\n\tfunction parseItems(npc, script) {\n\t\tu.getRegexGroup(script, /new Listview\\(\\{template: 'item', id: 'sells', (.*)\\);/, 1, s => {\n\t\t\tlet soldItems = [];\n\t\t\tlet regex = /\"name\":\"[0-9]([^\"]+)\".+?cost:\\[([0-9]+)/g;\n\t\t\tlet match;\n\t\t\t\n\t\t\twhile ((match = regex.exec(s)) !== null) {\n\t\t\t\tsoldItems.push(new SoldItem(match[1], parseInt(match[2])));\n\t\t\t}\n\t\t\t\n\t\t\tsoldItems.sort((s1, s2) => s1.compareTo(s2));\n\t\t\tnpc.itemsSold = soldItems;\n\t\t});\n\t}\n\t\n\t/**\n\t * @param {NPC} npc \n\t * @param {string} script\n\t */\n\tfunction parseSounds(npc, script) {\n\t\tu.getRegexGroup(script, \"new Listview\\\\(\\\\{template: 'sound', id: 'sounds', (.*)\\\\);\", 1, s => {\n\t\t\t// First, try to determine both race and gender from the attack sound\n\t\t\tlet raceGenderPattern = new RegExp(\n\t\t\t\t\t\"\\\"name\\\":\\\"([A-Za-z0-9_]+)\"\n\t\t\t\t\t+ \"(Male|Female|_MALE|_FEMALE)\"\n\t\t\t\t\t+ \"[A-Za-z0-9_]*\"\n\t\t\t\t\t+ \"(?:Attack|ATTACK)\\\"\");\n\t\t\t\n\t\t\tlet match = s.match(raceGenderPattern);\n\n\t\t\tif (match) {\n\t\t\t\tnpc.race = normalizeRaceName(match[1]);\n\t\t\t\t\n\t\t\t\tswitch (match[2]) {\n\t\t\t\tcase \"_MALE\":\n\t\t\t\t\tnpc.gender = \"Male\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"_FEMALE\":\n\t\t\t\t\tnpc.gender = \"Female\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tnpc.gender = match[2];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Try to determine just race\n\t\t\t\tu.getRegexGroup(s, \"\\\"name\\\":\\\"([A-Za-z0-9_]+)(?:Attack|ATTACK)\\\"\", 1, race => {\n\t\t\t\t\tnpc.race = normalizeRaceName(race);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\t\n\t/**\n\t * \n\t * @param {string} raceName \n\t */\n\tfunction normalizeRaceName(raceName) {\n\t\tlet transformed = raceName\n\t\t\t\t.replace(/Player/g, \"\")\n\t\t\t\t.replace(/^MON_/, \"\")\n\t\t\t\t.replace(/^VO_[0-9]*/, \"\");\n\t\t\n\t\tif (transformed.length === 0) {\n\t\t\treturn \"\";\n\t\t} else if (/^[A-Z0-9_]+$/.test(transformed)) {\n\t\t\t// Convert UPPERCASE_WITH_UNDERSCORES_CONVENTION to normal name (e.g. FROST_NYMPH -> Frost nymph)\n\t\t\t// Convert every uppercase character except the first to lowercase, and every underscore to space\n\t\t\tlet src = transformed.replace(/_/g, \" \").trim();\n\t\t\t\n\t\t\tif (src.length === 0) {\n\t\t\t\treturn \"\";\n\t\t\t}\n\t\t\t\n\t\t\treturn src.charAt(0) + src.substring(1).toLowerCase();\n\t\t} else {\n\t\t\t// Convert CamelCase to normal name (e.g. NightElf -> Night elf)\n\t\t\tlet src = transformed.replace(/_/g, \"\");\n\t\t\t\n\t\t\tif (src.length === 0) {\n\t\t\t\treturn \"\";\n\t\t\t}\n\t\t\t\n\t\t\treturn src.charAt(0) + src.substring(1).replace(/[A-Z]/g, ch => \" \" + ch.toLowerCase());\n\t\t}\n\t}\n\t\n\t/**\n\t * @param {NPC} npc \n\t * @param {Element} mainContainer\n\t */\n\tfunction parseQuotes(npc, mainContainer) {\n\t\tlet quotesDiv = null;\n\n\t\tfor (let link of mainContainer.querySelectorAll(\"a.disclosure-off\")) {\n\t\t\tif (link.textContent.includes(\"Quotes\")) {\n\t\t\t\tlet quotesEl = u.findNextElementSibling(link.parentElement, el => u.tagName(el) === \"div\");\n\n\t\t\t\tif (quotesEl !== null) {\n\t\t\t\t\tquotesDiv = quotesEl;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (quotesDiv !== null) {\n\t\t\tnpc.quotes = Array.from(quotesDiv.querySelectorAll(\"span.s2\"))\n\t\t\t\t\t.map(el => el.textContent.replace(/^.+ says: /g, \"\"));\n\t\t};\n\t}\n\t\n\t/**\n\t * @param {NPC} npc\n\t */\n\tfunction parseHealth(npc) {\n\t\tu.getElementContainingOwnText(document, \"script\", \"Health: \", script => {\n\t\t\tu.getRegexGroup(script.textContent, \"Health: ([0-9,]+)\", 1, health => {\n\t\t\t\tnpc.health = parseInt(health.replace(/,/g, \"\"));\n\t\t\t});\n\t\t});\n\t}\n\t\n\t/**\n\t * @param {NPC} npc\n\t */\n\tfunction parseInfobox(npc) {\n\t\t// Infobox section\n\t\t// Pattern-match each infobox line\n\t\tfor (let infoboxLine of u.getInfoboxLines(false)) {\n\t\t\tu.getRegexGroup(infoboxLine, \"Level: (.+)\", 1, levelStr => {\n\t\t\t\tlet match = levelStr.match(/([^ ]+)(?: - ([0-9]+))?/);\n\t\t\t\t\n\t\t\t\tif (match) {\n\t\t\t\t\tnpc.levelLow = match[1];\n\t\t\t\t\tnpc.levelHigh = match[2];\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Classification: (.+)\", 1, levelClassification => {\n\t\t\t\tnpc.levelClassification = levelClassification;\n\t\t\t});\n\n\t\t\tu.getRegexGroup(infoboxLine, \"React: (.+)\", 1, reaction => {\n\t\t\t\tu.getRegexGroup(reaction, \"<q([^>]*)>A\", 1, colorId => {\n\t\t\t\t\tnpc.allianceReaction = getReactionByColor(colorId);\n\t\t\t\t});\n\n\t\t\t\tu.getRegexGroup(reaction, \"<q([^>]*)>H\", 1, colorId => {\n\t\t\t\t\tnpc.hordeReaction = getReactionByColor(colorId);\n\t\t\t\t});\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Faction: (.+)\", 1, repFaction => {\n\t\t\t\tnpc.repFaction = repFaction;\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Tameable \\\\((.+)\\\\)\", 1, petFamily => {\n\t\t\t\tnpc.petFamily = petFamily;\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Worth: ([0-9]+)\", 1, money => {\n\t\t\t\tnpc.money = parseInt(money);\n\t\t\t});\n\t\t\t\n\t\t\tu.getRegexGroup(infoboxLine, \"Mana: ([0-9,]+)\", 1, mana => {\n\t\t\t\tnpc.mana = parseInt(mana.replace(/,/g, \"\"));\n\t\t\t});\n\n\t\t\tu.getRegexGroup(infoboxLine, \"Added in patch ([0-9]+.[0-9]+.[0-9]+)\", 1, patch => {\n\t\t\t\tnpc.patchAdded = substitutions.getCanonicalPatchVersion(patch);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * \n\t * @param {string} colorId \n\t */\n\tfunction getReactionByColor(colorId) {\n\t\tswitch (colorId) {\n\t\t\tcase \"\":\n\t\t\t\treturn \"Neutral\";\n\t\t\tcase \"2\":\n\t\t\t\treturn \"Friendly\";\n\t\t\tcase \"10\":\n\t\t\t\treturn \"Hostile\";\n\t\t\tdefault:\n\t\t\t\tthrow new Error();\n\t\t\t}\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./parsers/NPCParser.js\n// module id = 18\n// module chunks = 0","module.exports = function anonymous(locals, filters, escape, rethrow) {\n    escape = escape || function(html) {\n        return String(html).replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/'/g, \"&#39;\").replace(/\"/g, \"&quot;\");\n    };\n    var __stack = {\n        lineno: 1,\n        input: \"{{Stub/NPC}}\\n<% if (n.location) { -%>\\n{{screenshot||<%- n.location %>}}\\n<% } -%>\\n{{Npcbox\\n | name = <%- n.name %>\\n | image = <%- n.name %>.jpg\\n<% if (n.title) { -%>\\n | title = <%- n.title %>\\n<% } -%>\\n | gender = <%- n.gender %>\\n | level = <%- n.levelLow %><% if (n.levelHigh) { %> - <%- n.levelHigh %><% } %>\\n<% if (n.levelClassification) { -%>\\n | type = <%- n.levelClassification %>\\n<% } -%>\\n<% if (n.health) { -%>\\n | health = <%- n.healthStr %>\\n<% } -%>\\n<% if (n.mana) { -%>\\n | mana = <%- n.manaStr %>\\n<% } -%>\\n | faction = <%- n.getFaction() %>\\n | aggro = {{Aggro|<%- n.allianceReaction %>|<%- n.hordeReaction %>}}\\n | race = <%- n.race %>\\n | creature = <%- n.creatureType %>\\n<% if (n.repFaction) { -%>\\n | repfaction = <%- n.repFaction %>\\n<% } -%>\\n | location = <% if (n.location) { %>[[<%- n.location %>]]<% } %>\\n<% if (n.petFamily) { -%>\\n | pet = <%- n.petFamily %>\\n<% } -%>\\n<% if (n.money) { -%>\\n | money = {{Cost|<%- n.getGold() %>|<%- n.getSilver() %>|<%- n.getCopper() %>}}\\n<% } -%>\\n}}\\n'''<%- n.name %>''' is a<% if (n.isRaceStartsWithVowel()) { %>n<% } %> [[<%- (n.race || \\\"\\\").toLowerCase() %>]] located in [[<%- n.location %>]].\\n<% if (n.itemsSold.length) { -%>\\n\\n==Sells==\\n<% if (n.isUseItembox()) { -%>\\n{{Itembox\\n<% n.itemsSold.forEach(function(item, index) { -%>\\n|<%- item.name %>|c<%- (index + 1) %>={{Cost|<%- item.getGold() %>|<%- item.getSilver() %>|<%- item.getCopper() %>}}\\n<% }) -%>\\n}}\\n<% } else { -%>\\n{| class=\\\"darktable sortable zebra\\\"\\n! Item !! Cost\\n<% n.itemsSold.forEach(function(item) { -%>\\n|-\\n| [[<%- item.name %>]] || {{Cost|<%- item.getGold() %>|<%- item.getSilver() %>|<%- item.getCopper() %>}}\\n<% }) -%>\\n|}\\n<% } -%>\\n<% } -%>\\n<% if (n.quests.length) { -%>\\n\\n==Quests==\\n<% n.quests.forEach(function(quest) { -%>\\n* [[Quest:<%- quest.name %>]] <%\\n\tif (quest.starts) {\\n\t\tif (quest.finishes) {\\n\t\t\t%>{{queststartfinish}}<%\\n\t\t} else {\\n\t\t\t%>{{queststart}}<%\\n\t\t}\\n\t} else if (quest.finishes) {\\n\t\t%>{{questfinish}}<%\\n\t} %>\\n<% }) -%>\\n<% } -%>\\n<% if (n.quotes.length) { -%>\\n\\n==Quotes==\\n<% n.quotes.forEach(function(quote) { -%>\\n* <%- quote %>\\n<% }) -%>\\n<% } -%>\\n<% if (n.patchAdded) { -%>\\n\\n==Patch changes==\\n* {{Patch <%- n.patchAdded %>|note=Added.}}\\n<% } -%>\\n\\n==External links==\\n{{subst:el}}\\n{{Elinks-NPC|<%- n.id %>}}\\n\\n<% if (n.location) { -%>\\n[[Category:<%- n.location %> NPCs]]\\n<% } -%>\\n<% if (n.isQuestGiver()) { -%>\\n[[Category:Quest givers]]\\n<% } -%>\\n<% if (n.isQuestEnder()) { -%>\\n[[Category:Quest enders]]\\n<% } -%>\\n<% if (n.itemsSold.length) { -%>\\n[[Category:Vendors]]\\n<% } -%>\\n<% if (!n.location && !n.quests.length && !n.itemsSold.length) { -%>\\n[[Category:World of Warcraft NPCs]]\\n<% } -%>\\n\",\n        filename: \".\"\n    };\n    function rethrow(err, str, filename, lineno) {\n        var lines = str.split(\"\\n\"), start = Math.max(lineno - 3, 0), end = Math.min(lines.length, lineno + 3);\n        var context = lines.slice(start, end).map(function(line, i) {\n            var curr = i + start + 1;\n            return (curr == lineno ? \" >> \" : \"    \") + curr + \"| \" + line;\n        }).join(\"\\n\");\n        err.path = filename;\n        err.message = (filename || \"ejs\") + \":\" + lineno + \"\\n\" + context + \"\\n\\n\" + err.message;\n        throw err;\n    }\n    try {\n        var buf = [];\n        with (locals || {}) {\n            (function() {\n                buf.push(\"{{Stub/NPC}}\\n\");\n                __stack.lineno = 2;\n                if (n.location) {\n                    buf.push(\"{{screenshot||\", (__stack.lineno = 2, n.location), \"}}\\n\");\n                    __stack.lineno = 3;\n                }\n                buf.push(\"{{Npcbox\\n | name = \", (__stack.lineno = 4, n.name), \"\\n | image = \", (__stack.lineno = 5, n.name), \".jpg\\n\");\n                __stack.lineno = 6;\n                if (n.title) {\n                    buf.push(\" | title = \", (__stack.lineno = 6, n.title), \"\\n\");\n                    __stack.lineno = 7;\n                }\n                buf.push(\" | gender = \", (__stack.lineno = 7, n.gender), \"\\n | level = \", (__stack.lineno = 8, n.levelLow), \"\");\n                __stack.lineno = 8;\n                if (n.levelHigh) {\n                    buf.push(\" - \", (__stack.lineno = 8, n.levelHigh), \"\");\n                    __stack.lineno = 8;\n                }\n                buf.push(\"\\n\");\n                __stack.lineno = 9;\n                if (n.levelClassification) {\n                    buf.push(\" | type = \", (__stack.lineno = 9, n.levelClassification), \"\\n\");\n                    __stack.lineno = 10;\n                }\n                buf.push(\"\");\n                __stack.lineno = 10;\n                if (n.health) {\n                    buf.push(\" | health = \", (__stack.lineno = 10, n.healthStr), \"\\n\");\n                    __stack.lineno = 11;\n                }\n                buf.push(\"\");\n                __stack.lineno = 11;\n                if (n.mana) {\n                    buf.push(\" | mana = \", (__stack.lineno = 11, n.manaStr), \"\\n\");\n                    __stack.lineno = 12;\n                }\n                buf.push(\" | faction = \", (__stack.lineno = 12, n.getFaction()), \"\\n | aggro = {{Aggro|\", (__stack.lineno = 13, n.allianceReaction), \"|\", (__stack.lineno = 13, n.hordeReaction), \"}}\\n | race = \", (__stack.lineno = 14, n.race), \"\\n | creature = \", (__stack.lineno = 15, n.creatureType), \"\\n\");\n                __stack.lineno = 16;\n                if (n.repFaction) {\n                    buf.push(\" | repfaction = \", (__stack.lineno = 16, n.repFaction), \"\\n\");\n                    __stack.lineno = 17;\n                }\n                buf.push(\" | location = \");\n                __stack.lineno = 17;\n                if (n.location) {\n                    buf.push(\"[[\", (__stack.lineno = 17, n.location), \"]]\");\n                    __stack.lineno = 17;\n                }\n                buf.push(\"\\n\");\n                __stack.lineno = 18;\n                if (n.petFamily) {\n                    buf.push(\" | pet = \", (__stack.lineno = 18, n.petFamily), \"\\n\");\n                    __stack.lineno = 19;\n                }\n                buf.push(\"\");\n                __stack.lineno = 19;\n                if (n.money) {\n                    buf.push(\" | money = {{Cost|\", (__stack.lineno = 19, n.getGold()), \"|\", (__stack.lineno = 19, n.getSilver()), \"|\", (__stack.lineno = 19, n.getCopper()), \"}}\\n\");\n                    __stack.lineno = 20;\n                }\n                buf.push(\"}}\\n'''\", (__stack.lineno = 21, n.name), \"''' is a\");\n                __stack.lineno = 21;\n                if (n.isRaceStartsWithVowel()) {\n                    buf.push(\"n\");\n                    __stack.lineno = 21;\n                }\n                buf.push(\" [[\", (__stack.lineno = 21, (n.race || \"\").toLowerCase()), \"]] located in [[\", (__stack.lineno = 21, n.location), \"]].\\n\");\n                __stack.lineno = 22;\n                if (n.itemsSold.length) {\n                    buf.push(\"\\n==Sells==\\n\");\n                    __stack.lineno = 24;\n                    if (n.isUseItembox()) {\n                        buf.push(\"{{Itembox\\n\");\n                        __stack.lineno = 25;\n                        n.itemsSold.forEach(function(item, index) {\n                            buf.push(\"|\", (__stack.lineno = 25, item.name), \"|c\", (__stack.lineno = 25, index + 1), \"={{Cost|\", (__stack.lineno = 25, item.getGold()), \"|\", (__stack.lineno = 25, item.getSilver()), \"|\", (__stack.lineno = 25, item.getCopper()), \"}}\\n\");\n                            __stack.lineno = 26;\n                        });\n                        buf.push(\"}}\\n\");\n                        __stack.lineno = 27;\n                    } else {\n                        buf.push('{| class=\"darktable sortable zebra\"\\n! Item !! Cost\\n');\n                        __stack.lineno = 29;\n                        n.itemsSold.forEach(function(item) {\n                            buf.push(\"|-\\n| [[\", (__stack.lineno = 30, item.name), \"]] || {{Cost|\", (__stack.lineno = 30, item.getGold()), \"|\", (__stack.lineno = 30, item.getSilver()), \"|\", (__stack.lineno = 30, item.getCopper()), \"}}\\n\");\n                            __stack.lineno = 31;\n                        });\n                        buf.push(\"|}\\n\");\n                        __stack.lineno = 32;\n                    }\n                    buf.push(\"\");\n                    __stack.lineno = 32;\n                }\n                buf.push(\"\");\n                __stack.lineno = 32;\n                if (n.quests.length) {\n                    buf.push(\"\\n==Quests==\\n\");\n                    __stack.lineno = 34;\n                    n.quests.forEach(function(quest) {\n                        buf.push(\"* [[Quest:\", (__stack.lineno = 34, quest.name), \"]] \");\n                        __stack.lineno = 34;\n                        if (quest.starts) {\n                            if (quest.finishes) {\n                                buf.push(\"{{queststartfinish}}\");\n                                __stack.lineno = 37;\n                            } else {\n                                buf.push(\"{{queststart}}\");\n                                __stack.lineno = 39;\n                            }\n                        } else if (quest.finishes) {\n                            buf.push(\"{{questfinish}}\");\n                            __stack.lineno = 42;\n                        }\n                        buf.push(\"\\n\");\n                        __stack.lineno = 44;\n                    });\n                    buf.push(\"\");\n                    __stack.lineno = 44;\n                }\n                buf.push(\"\");\n                __stack.lineno = 44;\n                if (n.quotes.length) {\n                    buf.push(\"\\n==Quotes==\\n\");\n                    __stack.lineno = 46;\n                    n.quotes.forEach(function(quote) {\n                        buf.push(\"* \", (__stack.lineno = 46, quote), \"\\n\");\n                        __stack.lineno = 47;\n                    });\n                    buf.push(\"\");\n                    __stack.lineno = 47;\n                }\n                buf.push(\"\");\n                __stack.lineno = 47;\n                if (n.patchAdded) {\n                    buf.push(\"\\n==Patch changes==\\n* {{Patch \", (__stack.lineno = 49, n.patchAdded), \"|note=Added.}}\\n\");\n                    __stack.lineno = 50;\n                }\n                buf.push(\"\\n==External links==\\n{{subst:el}}\\n{{Elinks-NPC|\", (__stack.lineno = 53, n.id), \"}}\\n\\n\");\n                __stack.lineno = 55;\n                if (n.location) {\n                    buf.push(\"[[Category:\", (__stack.lineno = 55, n.location), \" NPCs]]\\n\");\n                    __stack.lineno = 56;\n                }\n                buf.push(\"\");\n                __stack.lineno = 56;\n                if (n.isQuestGiver()) {\n                    buf.push(\"[[Category:Quest givers]]\\n\");\n                    __stack.lineno = 57;\n                }\n                buf.push(\"\");\n                __stack.lineno = 57;\n                if (n.isQuestEnder()) {\n                    buf.push(\"[[Category:Quest enders]]\\n\");\n                    __stack.lineno = 58;\n                }\n                buf.push(\"\");\n                __stack.lineno = 58;\n                if (n.itemsSold.length) {\n                    buf.push(\"[[Category:Vendors]]\\n\");\n                    __stack.lineno = 59;\n                }\n                buf.push(\"\");\n                __stack.lineno = 59;\n                if (!n.location && !n.quests.length && !n.itemsSold.length) {\n                    buf.push(\"[[Category:World of Warcraft NPCs]]\\n\");\n                    __stack.lineno = 60;\n                }\n                buf.push(\"\");\n            })();\n        }\n        return buf.join(\"\");\n    } catch (err) {\n        rethrow(err, __stack.input, __stack.filename, __stack.lineno);\n    }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./templates/npc.ejs\n// module id = 19\n// module chunks = 0","const MAX_ITEMBOX_ITEMS = 30;\n\n/**\n * \n * @param {Array.<any>} array \n * @param {function} condition \n */\nfunction anyMatch(array, condition) {\n\tfor (let element of array) {\n\t\tif (condition(element)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nexport default class NPC {\n\tconstructor() {\n\t\tthis.quests = [];\n\t\tthis.quotes = [];\n\t\tthis.itemsSold = [];\n\t}\n\t\n\tisQuestGiver() {\n\t\treturn anyMatch(this.quests, q => q.starts);\n\t}\n\t\n\tisQuestEnder() {\n\t\treturn anyMatch(this.quests, q => q.finishes);\n\t}\n\t\n\tgetFaction() {\n\t\tif (this.allianceReaction == null && this.hordeReaction == null) {\n\t\t\treturn null;\n\t\t} else if (this.allianceReaction === \"Friendly\" && this.hordeReaction !== \"Friendly\") {\n\t\t\treturn \"Alliance\";\n\t\t} else if (this.allianceReaction !== \"Friendly\" && this.hordeReaction === \"Friendly\") {\n\t\t\treturn \"Horde\";\n\t\t} else if (this.allianceReaction === \"Hostile\" && this.hordeReaction === \"Hostile\") {\n\t\t\treturn \"Combat\";\n\t\t} else if (this.allianceReaction === \"Neutral\" && this.hordeReaction === \"Neutral\") {\n\t\t\treturn \"Combat\";\n\t\t} else {\n\t\t\treturn \"Neutral\";\n\t\t}\n\t}\n\t\n\tgetHealthStr() {\n\t\treturn new Intl.NumberFormat(\"en-US\").format(this.health);\n\t}\n\t\n\tgetManaStr() {\n\t\treturn mana == null ? null : new Intl.NumberFormat(\"en-US\").format(this.mana);\n\t}\n\n\tisUseItembox() {\n\t\treturn this.itemsSold.length <= MAX_ITEMBOX_ITEMS;\n\t}\n\t\n\tisRaceStartsWithVowel() {\n\t\treturn this.race && this.race.length && \"AEIOU\".includes(this.race.charAt(0));\n\t}\n\n\tgetGold() {\n\t\treturn Math.floor(this.money / 10000) || \"\";\n\t}\n\n\tgetSilver() {\n\t\treturn (Math.floor(this.money / 100) % 100) || \"\";\n\t}\n\n\tgetCopper() {\n\t\treturn (this.money % 100) || \"\";\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./model/npc/NPC.js\n// module id = 20\n// module chunks = 0","export default class NPCQuest {\n\t/**\n\t * \n\t * @param {string} name \n\t * @param {boolean} starts \n\t * @param {boolean} finishes \n\t */\n\tconstructor(name, starts, finishes) {\n\t\tthis.name = name;\n\t\tthis.starts = starts;\n\t\tthis.finishes = finishes;\n\t}\n\n\t/**\n\t * \n\t * @param {NPCQuest} other \n\t */\n\tcompareTo(other) {\n\t\treturn this.name.localeCompare(other.name);\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./model/npc/NPCQuest.js\n// module id = 21\n// module chunks = 0","export default class SoldItem {\n\t/**\n\t * \n\t * @param {string} name \n\t * @param {number} price \n\t */\n\tconstructor(name, price) {\n\t\tthis.name = name;\n\t\tthis.price = price || 0;\n\t}\n\n\tgetGold() {\n\t\treturn Math.floor(this.price / 10000) || \"\";\n\t}\n\n\tgetSilver() {\n\t\treturn (Math.floor(this.price / 100) % 100) || \"\";\n\t}\n\n\tgetCopper() {\n\t\treturn (this.price % 100) || \"\";\n\t}\n\n\t/**\n\t * \n\t * @param {SoldItem} other \n\t */\n\tcompareTo(other) {\n\t\treturn this.name.localeCompare(other.name);\n\t}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./model/npc/SoldItem.js\n// module id = 22\n// module chunks = 0"],"sourceRoot":""}